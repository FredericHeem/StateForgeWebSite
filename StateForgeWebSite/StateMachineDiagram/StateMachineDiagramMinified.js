window.Modernizr=function(a,b,c){function z(){e.input=function(a){for(var b=0,c=a.length;b<c;b++){q[a[b]]=a[b] in l}return q}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++){l.setAttribute("type",f=a[d]),e=l.type!=="text",e&&(l.value=m,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&l.style.WebkitAppearance!==c?(g.appendChild(l),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(l,null).WebkitAppearance!=="textfield"&&l.offsetHeight!==0,g.removeChild(l)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=l.checkValidity&&l.checkValidity()===!1:/^color$/.test(f)?(g.appendChild(l),g.offsetWidth,e=l.value!=m,g.removeChild(l)):e=l.value!=m)),p[a[d]]=!!e}return p}("search tel url email datetime date month week time datetime-local number range color".split(" "))}function y(a,b){return !!~(""+a).indexOf(b)}function x(a,b){return typeof a===b}function w(a,b){return v(prefixes.join(a+";")+(b||""))}function v(a){k.cssText=a}var d="2.0.4",e={},f=!0,g=b.documentElement,h=b.head||b.getElementsByTagName("head")[0],i="modernizr",j=b.createElement(i),k=j.style,l=b.createElement("input"),m=":)",n=Object.prototype.toString,o={},p={},q={},r=[],s,t={}.hasOwnProperty,u;!x(t,c)&&!x(t.call,c)?u=function(a,b){return t.call(a,b)}:u=function(a,b){return b in a&&x(a.constructor.prototype[b],c)},o.localstorage=function(){try{return !!localStorage.getItem}catch(a){return !1}};for(var A in o){u(o,A)&&(s=A.toLowerCase(),e[s]=o[A](),r.push((e[s]?"":"no-")+s))}e.input||z(),v(""),j=l=null,a.attachEvent&&function(){var a=b.createElement("div");a.innerHTML="<elem></elem>";return a.childNodes.length!==1}()&&function(a,b){function s(a){var b=-1;while(++b<g){a.createElement(f[b])}}a.iepp=a.iepp||{};var d=a.iepp,e=d.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",f=e.split("|"),g=f.length,h=new RegExp("(^|\\s)("+e+")","gi"),i=new RegExp("<(/*)("+e+")","gi"),j=/^\s*[\{\}]\s*$/,k=new RegExp("(^|[^\\n]*?\\s)("+e+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),l=b.createDocumentFragment(),m=b.documentElement,n=m.firstChild,o=b.createElement("body"),p=b.createElement("style"),q=/print|all/,r;d.getCSS=function(a,b){if(a+""===c){return""}var e=-1,f=a.length,g,h=[];while(++e<f){g=a[e];if(g.disabled){continue}b=g.media||b,q.test(b)&&h.push(d.getCSS(g.imports,b),g.cssText),b="all"}return h.join("")},d.parseCSS=function(a){var b=[],c;while((c=k.exec(a))!=null){b.push(((j.exec(c[1])?"\n":c[1])+c[2]+c[3]).replace(h,"$1.iepp_$2")+c[4])}return b.join("\n")},d.writeHTML=function(){var a=-1;r=r||b.body;while(++a<g){var c=b.getElementsByTagName(f[a]),d=c.length,e=-1;while(++e<d){c[e].className.indexOf("iepp_")<0&&(c[e].className+=" iepp_"+f[a])}}l.appendChild(r),m.appendChild(o),o.className=r.className,o.id=r.id,o.innerHTML=r.innerHTML.replace(i,"<$1font")},d._beforePrint=function(){p.styleSheet.cssText=d.parseCSS(d.getCSS(b.styleSheets,"all")),d.writeHTML()},d.restoreHTML=function(){o.innerHTML="",m.removeChild(o),m.appendChild(r)},d._afterPrint=function(){d.restoreHTML(),p.styleSheet.cssText=""},s(b),s(l);d.disablePP||(n.insertBefore(p,n.firstChild),p.media="print",p.className="iepp-printshim",a.attachEvent("onbeforeprint",d._beforePrint),a.attachEvent("onafterprint",d._afterPrint))}(a,b),e._version=d,g.className=g.className.replace(/\bno-js\b/,"")+(f?" js "+r.join(" "):"");return e}(this,this.document),function(a,b,c){function k(a){return !a||a=="loaded"||a=="complete"}function j(){var a=1,b=-1;while(p.length- ++b){if(p[b].s&&!(a=p[b].r)){break}}a&&g()}function i(a){var c=b.createElement("script"),d;c.src=a.s,c.onreadystatechange=c.onload=function(){!d&&k(c.readyState)&&(d=1,j(),c.onload=c.onreadystatechange=null)},m(function(){d||(d=1,j())},H.errorTimeout),a.e?c.onload():n.parentNode.insertBefore(c,n)}function h(a){var c=b.createElement("link"),d;c.href=a.s,c.rel="stylesheet",c.type="text/css",!a.e&&(w||r)?function a(b){m(function(){if(!d){try{b.sheet.cssRules.length?(d=1,j()):a(b)}catch(c){c.code==1000||c.message=="security"||c.message=="denied"?(d=1,m(function(){j()},0)):a(b)}}},0)}(c):(c.onload=function(){d||(d=1,m(function(){j()},0))},a.e&&c.onload()),m(function(){d||(d=1,j())},H.errorTimeout),!a.e&&n.parentNode.insertBefore(c,n)}function g(){var a=p.shift();q=1,a?a.t?m(function(){a.t=="c"?h(a):i(a)},0):(a(),j()):q=0}function f(a,c,d,e,f,h){function i(){!o&&k(l.readyState)&&(r.r=o=1,!q&&j(),l.onload=l.onreadystatechange=null,m(function(){u.removeChild(l)},0))}var l=b.createElement(a),o=0,r={t:d,s:c,e:h};l.src=l.data=c,!s&&(l.style.display="none"),l.width=l.height="0",a!="object"&&(l.type=d),l.onload=l.onreadystatechange=i,a=="img"?l.onerror=i:a=="script"&&(l.onerror=function(){r.e=r.r=1,g()}),p.splice(e,0,r),u.insertBefore(l,s?null:n),m(function(){o||(u.removeChild(l),r.r=r.e=o=1,j())},H.errorTimeout)}function e(a,b,c){var d=b=="c"?z:y;q=0,b=b||"j",C(a)?f(d,a,b,this.i++,l,c):(p.splice(this.i++,0,a),p.length==1&&g());return this}function d(){var a=H;a.loader={load:e,i:0};return a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance" in l.style,s=r&&!!b.createRange().compareNode,t=r&&!s,u=s?l:n.parentNode,v=a.opera&&o.call(a.opera)=="[object Opera]",w="webkitAppearance" in l.style,x=w&&"async" in b.createElement("script"),y=r?"object":v||x?"img":"script",z=w?"img":y,A=Array.isArray||function(a){return o.call(a)=="[object Array]"},B=function(a){return typeof a=="object"},C=function(a){return typeof a=="string"},D=function(a){return o.call(a)=="[object Function]"},E=[],F={},G,H;H=function(a){function f(a){var b=a.split("!"),c=E.length,d=b.pop(),e=b.length,f={url:d,origUrl:d,prefixes:b},g,h;for(h=0;h<e;h++){g=F[b[h]],g&&(f=g(f))}for(h=0;h<c;h++){f=E[h](f)}return f}function e(a,b,e,g,h){var i=f(a),j=i.autoCallback;if(!i.bypass){b&&(b=D(b)?b:b[a]||b[g]||b[a.split("/").pop().split("?")[0]]);if(i.instead){return i.instead(a,b,e,g,h)}e.load(i.url,i.forceCSS||!i.forceJS&&/css$/.test(i.url)?"c":c,i.noexec),(D(b)||D(j))&&e.load(function(){d(),b&&b(i.origUrl,h,g),j&&j(i.origUrl,h,g)})}}function b(a,b){function c(a){if(C(a)){e(a,h,b,0,d)}else{if(B(a)){for(i in a){a.hasOwnProperty(i)&&e(a[i],h,b,i,d)}}}}var d=!!a.test,f=d?a.yep:a.nope,g=a.load||a.both,h=a.callback,i;c(f),c(g),a.complete&&b.load(a.complete)}var g,h,i=this.yepnope.loader;if(C(a)){e(a,0,i,0)}else{if(A(a)){for(g=0;g<a.length;g++){h=a[g],C(h)?e(h,0,i,0):A(h)?H(h):B(h)&&b(h,i)}}else{B(a)&&b(a,i)}}},H.addPrefix=function(a,b){F[a]=b},H.addFilter=function(a){E.push(a)},H.errorTimeout=10000,b.readyState==null&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",G=function(){b.removeEventListener("DOMContentLoaded",G,0),b.readyState="complete"},0)),a.yepnope=d()}(this,this.document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};(function(a,b,c){function B(b,g){function w(a){var b=a.precedance==="y",c=n[b?"width":"height"],d=n[b?"height":"width"],e=a.string().indexOf("center")>-1,f=c*(e?0.5:1),g=Math.pow,h=Math.round,i,j,k,l=Math.sqrt(g(f,2)+g(d,2)),m=[p/f*l,p/d*l];m[2]=Math.sqrt(g(m[0],2)-g(p,2)),m[3]=Math.sqrt(g(m[1],2)-g(p,2)),i=l+m[2]+m[3]+(e?0:m[0]),j=i/l,k=[h(j*d),h(j*c)];return{height:k[b?0:1],width:k[b?1:0]}}function v(b){var c=k.titlebar&&b.y==="top",d=c?k.titlebar:k.content,e=a.browser.mozilla,f=e?"-moz-":a.browser.webkit?"-webkit-":"",g=b.y+(e?"":"-")+b.x,h=f+(e?"border-radius-"+g:"border-"+g+"-radius");return parseInt(d.css(h),10)||parseInt(l.css(h),10)||0}function u(a,b,c){b=b?b:a[a.precedance];var d=l.hasClass(r),e=k.titlebar&&a.y==="top",f=e?k.titlebar:k.content,g="border-"+b+"-width",h;l.addClass(r),h=parseInt(f.css(g),10),h=(c?h||parseInt(l.css(g),10):h)||0,l.toggleClass(r,d);return h}function t(f,g,h,l){if(k.tip){var n=a.extend({},i.corner),o=h.adjusted,p=b.options.position.adjust.method.split(" "),q=p[0],r=p[1]||p[0],s={left:e,top:e,x:0,y:0},t,u={},v;i.corner.fixed!==d&&(q==="shift"&&n.precedance==="x"&&o.left&&n.y!=="center"?n.precedance=n.precedance==="x"?"y":"x":q==="flip"&&o.left&&(n.x=n.x==="center"?o.left>0?"left":"right":n.x==="left"?"right":"left"),r==="shift"&&n.precedance==="y"&&o.top&&n.x!=="center"?n.precedance=n.precedance==="y"?"x":"y":r==="flip"&&o.top&&(n.y=n.y==="center"?o.top>0?"top":"bottom":n.y==="top"?"bottom":"top"),n.string()!==m.corner&&(m.top!==o.top||m.left!==o.left)&&i.update(n,e)),t=i.position(n,o),t.right!==c&&(t.left=-t.right),t.bottom!==c&&(t.top=-t.bottom),t.user=Math.max(0,j.offset);if(s.left=q==="shift"&&!!o.left){n.x==="center"?u["margin-left"]=s.x=t["margin-left"]-o.left:(v=t.right!==c?[o.left,-t.left]:[-o.left,t.left],(s.x=Math.max(v[0],v[1]))>v[0]&&(h.left-=o.left,s.left=e),u[t.right!==c?"right":"left"]=s.x)}if(s.top=r==="shift"&&!!o.top){n.y==="center"?u["margin-top"]=s.y=t["margin-top"]-o.top:(v=t.bottom!==c?[o.top,-t.top]:[-o.top,t.top],(s.y=Math.max(v[0],v[1]))>v[0]&&(h.top-=o.top,s.top=e),u[t.bottom!==c?"bottom":"top"]=s.y)}k.tip.css(u).toggle(!(s.x&&s.y||n.x==="center"&&s.y||n.y==="center"&&s.x)),h.left-=t.left.charAt?t.user:q!=="shift"||s.top||!s.left&&!s.top?t.left:0,h.top-=t.top.charAt?t.user:r!=="shift"||s.left||!s.left&&!s.top?t.top:0,m.left=o.left,m.top=o.top,m.corner=n.string()}}var i=this,j=b.options.style.tip,k=b.elements,l=k.tooltip,m={top:0,left:0,corner:""},n={width:j.width,height:j.height},o={},p=j.border||0,q=".qtip-tip",s=!!(a("<canvas />")[0]||{}).getContext;i.mimic=i.corner=f,i.border=p,i.offset=j.offset,i.size=n,b.checks.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){i.init()||i.destroy(),b.reposition()},"^style.tip.(height|width)$":function(){n={width:j.width,height:j.height},i.create(),i.update(),b.reposition()},"^content.title.text|style.(classes|widget)$":function(){k.tip&&i.update()}},a.extend(i,{init:function(){var b=i.detectCorner()&&(s||a.browser.msie);b&&(i.create(),i.update(),l.unbind(q).bind("tooltipmove"+q,t));return b},detectCorner:function(){var a=j.corner,c=b.options.position,f=c.at,g=c.my.string?c.my.string():c.my;if(a===e||g===e&&f===e){return e}a===d?i.corner=new h.Corner(g):a.string||(i.corner=new h.Corner(a),i.corner.fixed=d);return i.corner.string()!=="centercenter"},detectColours:function(){var c,d,e,f=k.tip.css({backgroundColor:"",border:""}),g=i.corner,h=g[g.precedance],m="border-"+h+"-color",p="border"+h.charAt(0)+h.substr(1)+"Color",q=/rgba?\(0, 0, 0(, 0)?\)|transparent/i,s="background-color",t="transparent",u=a(document.body).css("color"),v=b.elements.content.css("color"),w=k.titlebar&&(g.y==="top"||g.y==="center"&&f.position().top+n.height/2+j.offset<k.titlebar.outerHeight(1)),x=w?k.titlebar:k.content;l.addClass(r),o.fill=d=f.css(s),o.border=e=f[0].style[p]||f.css(m)||l.css(m);if(!d||q.test(d)){o.fill=x.css(s)||t,q.test(o.fill)&&(o.fill=l.css(s)||d)}if(!e||q.test(e)||e===u){o.border=x.css(m)||t;if(q.test(o.border)||o.border===v){o.border=e}}a("*",f).add(f).css(s,t).css("border",""),l.removeClass(r)},create:function(){var b=n.width,c=n.height,d;k.tip&&k.tip.remove(),k.tip=a("<div />",{"class":"ui-tooltip-tip"}).css({width:b,height:c}).prependTo(l),s?a("<canvas />").appendTo(k.tip)[0].getContext("2d").save():(d='<vml:shape coordorigin="0,0" style="display:inline-block; position:absolute; behavior:url(#default#VML);"></vml:shape>',k.tip.html(d+d))},update:function(b,c){var g=k.tip,l=g.children(),m=n.width,q=n.height,r="px solid ",t="px dashed transparent",v=j.mimic,x=Math.round,y,z,B,C,D;b||(b=i.corner),v===e?v=b:(v=new h.Corner(v),v.precedance=b.precedance,v.x==="inherit"?v.x=b.x:v.y==="inherit"?v.y=b.y:v.x===v.y&&(v[b.precedance]=b[b.precedance])),y=v.precedance,i.detectColours(),o.border!=="transparent"&&o.border!=="#123456"?(p=u(b,f,d),j.border===0&&p>0&&(o.fill=o.border),i.border=p=j.border!==d?j.border:p):i.border=p=0,B=A(v,m,q),i.size=D=w(b),g.css(D),b.precedance==="y"?C=[x(v.x==="left"?p:v.x==="right"?D.width-m-p:(D.width-m)/2),x(v.y==="top"?D.height-q:0)]:C=[x(v.x==="left"?D.width-m:0),x(v.y==="top"?p:v.y==="bottom"?D.height-q-p:(D.height-q)/2)],s?(l.attr(D),z=l[0].getContext("2d"),z.restore(),z.save(),z.clearRect(0,0,3000,3000),z.translate(C[0],C[1]),z.beginPath(),z.moveTo(B[0][0],B[0][1]),z.lineTo(B[1][0],B[1][1]),z.lineTo(B[2][0],B[2][1]),z.closePath(),z.fillStyle=o.fill,z.strokeStyle=o.border,z.lineWidth=p*2,z.lineJoin="miter",z.miterLimit=100,p&&z.stroke(),z.fill()):(B="m"+B[0][0]+","+B[0][1]+" l"+B[1][0]+","+B[1][1]+" "+B[2][0]+","+B[2][1]+" xe",C[2]=p&&/^(r|b)/i.test(b.string())?parseFloat(a.browser.version,10)===8?2:1:0,l.css({antialias:""+(v.string().indexOf("center")>-1),left:C[0]-C[2]*Number(y==="x"),top:C[1]-C[2]*Number(y==="y"),width:m+p,height:q+p}).each(function(b){var c=a(this);c[c.prop?"prop":"attr"]({coordsize:m+p+" "+(q+p),path:B,fillcolor:o.fill,filled:!!b,stroked:!b}).css({display:p||b?"block":"none"}),!b&&c.html()===""&&c.html('<vml:stroke weight="'+p*2+'px" color="'+o.border+'" miterlimit="1000" joinstyle="miter"  style="behavior:url(#default#VML); display:inline-block;" />')})),c!==e&&i.position(b)},position:function(b){var c=k.tip,f={},g=Math.max(0,j.offset),h,l,m;if(j.corner===e||!c){return e}b=b||i.corner,h=b.precedance,l=w(b),m=[b.x,b.y],h==="x"&&m.reverse(),a.each(m,function(a,c){var e,i;c==="center"?(e=h==="y"?"left":"top",f[e]="50%",f["margin-"+e]=-Math.round(l[h==="y"?"width":"height"]/2)+g):(e=u(b,c,d),i=v(b),f[c]=a?p?u(b,c):0:g+(i>e?i:0))}),f[b[h]]-=l[h==="x"?"width":"height"],c.css({top:"",bottom:"",left:"",right:"",margin:""}).css(f);return f},destroy:function(){k.tip&&k.tip.remove(),l.unbind(q)}}),i.init()}function A(a,b,c){var d=Math.ceil(b/2),e=Math.ceil(c/2),f={bottomright:[[0,0],[b,c],[b,0]],bottomleft:[[0,0],[b,0],[0,c]],topright:[[0,c],[b,0],[b,c]],topleft:[[0,0],[0,c],[b,c]],topcenter:[[0,c],[d,0],[b,c]],bottomcenter:[[0,0],[b,0],[d,c]],rightcenter:[[0,0],[b,e],[0,c]],leftcenter:[[b,0],[b,c],[0,e]]};f.lefttop=f.bottomright,f.righttop=f.bottomleft,f.leftbottom=f.topright,f.rightbottom=f.topleft;return f[a.string()]}function z(b,c){var i,j,k,l,m,n=a(this),o=a(document.body),p=this===document?o:n,q=n.metadata?n.metadata(c.metadata):f,r=c.metadata.type==="html5"&&q?q[c.metadata.name]:f,s=n.data(c.metadata.name||"qtipopts");try{s=typeof s==="string"?(new Function("return "+s))():s}catch(t){w("Unable to parse HTML5 attribute data: "+s)}l=a.extend(d,{},g.defaults,c,typeof s==="object"?x(s):f,x(r||q)),j=l.position,l.id=b;if("boolean"===typeof l.content.text){k=n.attr(l.content.attr);if(l.content.attr!==e&&k){l.content.text=k}else{w("Unable to locate content for tooltip! Aborting render of tooltip on element: ",n);return e}}j.container===e&&(j.container=o),j.target===e&&(j.target=p),l.show.target===e&&(l.show.target=p),l.show.solo===d&&(l.show.solo=o),l.hide.target===e&&(l.hide.target=p),l.position.viewport===d&&(l.position.viewport=j.container),j.at=new h.Corner(j.at),j.my=new h.Corner(j.my);if(a.data(this,"qtip")){if(l.overwrite){n.qtip("destroy")}else{if(l.overwrite===e){return e}}}l.suppress&&(m=a.attr(this,"title"))&&a(this).removeAttr("title").attr(u,m),i=new y(n,l,b,!!k),a.data(this,"qtip",i),n.bind("remove.qtip-"+b,function(){i.destroy()});return i}function y(s,t,w,y){function R(){var c=[t.show.target[0],t.hide.target[0],z.rendered&&G.tooltip[0],t.position.container[0],t.position.viewport[0],b,document];z.rendered?a([]).pushStack(a.grep(c,function(a){return typeof a==="object"})).unbind(F):t.show.target.unbind(F+"-create")}function Q(){function p(a){E.is(":visible")&&z.reposition(a)}function o(a){if(E.hasClass(m)){return e}clearTimeout(z.timers.inactive),z.timers.inactive=setTimeout(function(){z.hide(a)},t.hide.inactive)}function l(b){if(E.hasClass(m)||C||D){return e}var d=a(b.relatedTarget||b.target),g=d.closest(n)[0]===E[0],h=d[0]===f.show[0];clearTimeout(z.timers.show),clearTimeout(z.timers.hide);if(c.target==="mouse"&&g||t.hide.fixed&&(/mouse(out|leave|move)/.test(b.type)&&(g||h))){try{b.preventDefault(),b.stopImmediatePropagation()}catch(i){}}else{t.hide.delay>0?z.timers.hide=setTimeout(function(){z.hide(b)},t.hide.delay):z.hide(b)}}function k(a){if(E.hasClass(m)){return e}f.show.trigger("qtip-"+w+"-inactive"),clearTimeout(z.timers.show),clearTimeout(z.timers.hide);var b=function(){z.toggle(d,a)};t.show.delay>0?z.timers.show=setTimeout(b,t.show.delay):b()}var c=t.position,f={show:t.show.target,hide:t.hide.target,viewport:a(c.viewport),document:a(document),window:a(b)},h={show:a.trim(""+t.show.event).split(" "),hide:a.trim(""+t.hide.event).split(" ")},j=a.browser.msie&&parseInt(a.browser.version,10)===6;E.bind("mouseenter"+F+" mouseleave"+F,function(a){var b=a.type==="mouseenter";b&&z.focus(a),E.toggleClass(q,b)}),t.hide.fixed&&(f.hide=f.hide.add(E),E.bind("mouseover"+F,function(){E.hasClass(m)||clearTimeout(z.timers.hide)})),/mouse(out|leave)/i.test(t.hide.event)?t.hide.leave==="window"&&f.window.bind("mouseout"+F,function(a){/select|option/.test(a.target)&&!a.relatedTarget&&z.hide(a)}):/mouse(over|enter)/i.test(t.show.event)&&f.hide.bind("mouseleave"+F,function(a){clearTimeout(z.timers.show)}),(""+t.hide.event).indexOf("unfocus")>-1&&f.document.bind("mousedown"+F,function(b){var c=a(b.target),d=!E.hasClass(m)&&E.is(":visible");c[0]!==E[0]&&c.parents(n).length===0&&c.add(s).length>1&&!c.is(":disabled")&&z.hide(b)}),"number"===typeof t.hide.inactive&&(f.show.bind("qtip-"+w+"-inactive",o),a.each(g.inactiveEvents,function(a,b){f.hide.add(G.tooltip).bind(b+F+"-inactive",o)})),a.each(h.hide,function(b,c){var d=a.inArray(c,h.show),e=a(f.hide);d>-1&&e.add(f.show).length===e.length||c==="unfocus"?(f.show.bind(c+F,function(a){E.is(":visible")?l(a):k(a)}),delete h.show[d]):f.hide.bind(c+F,l)}),a.each(h.show,function(a,b){f.show.bind(b+F,k)}),"number"===typeof t.hide.distance&&f.show.add(E).bind("mousemove"+F,function(a){var b=H.origin||{},c=t.hide.distance,d=Math.abs;(d(a.pageX-b.pageX)>=c||d(a.pageY-b.pageY)>=c)&&z.hide(a)}),c.target==="mouse"&&(f.show.bind("mousemove"+F,function(a){i={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),c.adjust.mouse&&(t.hide.event&&E.bind("mouseleave"+F,function(a){(a.relatedTarget||a.target)!==f.show[0]&&z.hide(a)}),f.document.bind("mousemove"+F,function(a){!E.hasClass(m)&&E.is(":visible")&&z.reposition(a||i)}))),(c.adjust.resize||f.viewport.length)&&(a.event.special.resize?f.viewport:f.window).bind("resize"+F,p),(f.viewport.length||j&&E.css("position")==="fixed")&&f.viewport.bind("scroll"+F,p)}function P(b,d){function g(b){function i(c){c&&(delete h[c.src],clearTimeout(z.timers.img[c.src]),a(c).unbind(F)),a.isEmptyObject(h)&&(z.redraw(),d!==e&&z.reposition(H.event),b())}var g,h={};if((g=f.find("img:not([height]):not([width])")).length===0){return i()}g.each(function(b,d){if(h[d.src]===c){var e=0,f=3;(function g(){if(d.height||d.width||e>f){return i(d)}e+=1,z.timers.img[d.src]=setTimeout(g,700)})(),a(d).bind("error"+F+" load"+F,function(){i(this)}),h[d.src]=d}})}var f=G.content;if(!z.rendered||!b){return e}a.isFunction(b)&&(b=b.call(s,H.event,z)||""),b.jquery&&b.length>0?f.empty().append(b.css({display:"block"})):f.html(b),z.rendered<0?E.queue("fx",g):(D=0,g(a.noop));return z}function O(b,c){var d=G.title;if(!z.rendered||!b){return e}a.isFunction(b)&&(b=b.call(s,H.event,z));if(b===e){return K(e)}b.jquery&&b.length>0?d.empty().append(b.css({display:"block"})):d.html(b),z.redraw(),c!==e&&z.rendered&&E.is(":visible")&&z.reposition(H.event)}function N(a){var b=G.button,c=G.title;if(!z.rendered){return e}a?(c||M(),L()):b.remove()}function M(){var b=B+"-title";G.titlebar&&K(),G.titlebar=a("<div />",{"class":k+"-titlebar "+(t.style.widget?"ui-widget-header":"")}).append(G.title=a("<div />",{id:b,"class":k+"-title","aria-atomic":d})).insertBefore(G.content).delegate(".ui-state-default","mousedown keydown mouseup keyup mouseout",function(b){a(this).toggleClass("ui-state-active ui-state-focus",b.type.substr(-4)==="down")}).delegate(".ui-state-default","mouseover mouseout",function(b){a(this).toggleClass("ui-state-hover",b.type==="mouseover")}),t.content.title.button?L():z.rendered&&z.redraw()}function L(){var b=t.content.title.button,c=typeof b==="string",d=c?b:"Close tooltip";G.button&&G.button.remove(),b.jquery?G.button=b:G.button=a("<a />",{"class":"ui-state-default "+(t.style.widget?"":k+"-icon"),title:d,"aria-label":d}).prepend(a("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),G.button.appendTo(G.titlebar).attr("role","button").click(function(a){E.hasClass(m)||z.hide(a);return e}),z.redraw()}function K(a){G.title&&(G.titlebar.remove(),G.titlebar=G.title=G.button=f,a!==e&&z.reposition())}function J(){var a=t.style.widget;E.toggleClass(l,a).toggleClass(o,!a),G.content.toggleClass(l+"-content",a),G.titlebar&&G.titlebar.toggleClass(l+"-header",a),G.button&&G.button.toggleClass(k+"-icon",!a)}function I(a){var b=0,c,d=t,e=a.split(".");while(d=d[e[b++]]){b<e.length&&(c=d)}return[c||t,e.pop()]}var z=this,A=document.body,B=k+"-"+w,C=0,D=0,E=a(),F=".qtip-"+w,G,H;z.id=w,z.rendered=e,z.elements=G={target:s},z.timers={img:{}},z.options=t,z.checks={},z.plugins={},z.cache=H={event:{},target:a(),disabled:e,attr:y},z.checks.builtin={"^id$":function(b,c,f){var h=f===d?g.nextid:f,i=k+"-"+h;h!==e&&h.length>0&&!a("#"+i).length&&(E[0].id=i,G.content[0].id=i+"-content",G.title[0].id=i+"-title")},"^content.text$":function(a,b,c){P(c)},"^content.title.text$":function(a,b,c){if(!c){return K()}!G.title&&c&&M(),O(c)},"^content.title.button$":function(a,b,c){N(c)},"^position.(my|at)$":function(a,b,c){"string"===typeof c&&(a[b]=new h.Corner(c))},"^position.container$":function(a,b,c){z.rendered&&E.appendTo(c)},"^show.ready$":function(){z.rendered?z.toggle(d):z.render(1)},"^style.classes$":function(a,b,c){E.attr("class",k+" qtip ui-helper-reset "+c)},"^style.widget|content.title":J,"^events.(render|show|move|hide|focus|blur)$":function(b,c,d){E[(a.isFunction(d)?"":"un")+"bind"]("tooltip"+c,d)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=t.position;E.attr("tracking",a.target==="mouse"&&a.adjust.mouse),R(),Q()}},a.extend(z,{render:function(b){if(z.rendered){return z}var c=t.content.text,f=t.content.title.text,g=t.position,i=a.Event("tooltiprender");a.attr(s[0],"aria-describedby",B),E=G.tooltip=a("<div/>",{id:B,"class":k+" qtip ui-helper-reset "+o+" "+t.style.classes+" "+k+"-pos-"+t.position.my.abbreviation(),width:t.style.width||"",height:t.style.height||"",tracking:g.target==="mouse"&&g.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":e,"aria-describedby":B+"-content","aria-hidden":d}).toggleClass(m,H.disabled).data("qtip",z).appendTo(t.position.container).append(G.content=a("<div />",{"class":k+"-content",id:B+"-content","aria-atomic":d})),z.rendered=-1,C=D=1,f&&(M(),a.isFunction(f)||O(f,e)),a.isFunction(c)||P(c,e),z.rendered=d,J(),a.each(t.events,function(b,c){a.isFunction(c)&&E.bind(b==="toggle"?"tooltipshow tooltiphide":"tooltip"+b,c)}),a.each(h,function(){this.initialize==="render"&&this(z)}),Q(),E.queue("fx",function(a){i.originalEvent=H.event,E.trigger(i,[z]),C=D=0,z.redraw(),(t.show.ready||b)&&z.toggle(d,H.event),a()});return z},get:function(a){var b,c;switch(a.toLowerCase()){case"dimensions":b={height:E.outerHeight(),width:E.outerWidth()};break;case"offset":b=h.offset(E,t.position.container);break;default:c=I(a.toLowerCase()),b=c[0][c[1]],b=b.precedance?b.string():b}return b},set:function(b,c){function m(a,b){var c,d,e;for(c in k){for(d in k[c]){if(e=(new RegExp(d,"i")).exec(a)){b.push(e),k[c][d].apply(z,b)}}}}var g=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,h=/^content\.(title|attr)|style/i,i=e,j=e,k=z.checks,l;"string"===typeof b?(l=b,b={},b[l]=c):b=a.extend(d,{},b),a.each(b,function(c,d){var e=I(c.toLowerCase()),f;f=e[0][e[1]],e[0][e[1]]="object"===typeof d&&d.nodeType?a(d):d,b[c]=[e[0],e[1],d,f],i=g.test(c)||i,j=h.test(c)||j}),x(t),C=D=1,a.each(b,m),C=D=0,E.is(":visible")&&z.rendered&&(i&&z.reposition(t.position.target==="mouse"?f:H.event),j&&z.redraw());return z},toggle:function(b,c){function q(){b?(a.browser.msie&&E[0].style.removeAttribute("filter"),E.css("overflow",""),"string"===typeof h.autofocus&&a(h.autofocus,E).focus(),p=a.Event("tooltipvisible"),p.originalEvent=c?H.event:f,E.trigger(p,[z])):E.css({display:"",visibility:"",opacity:"",left:"",top:""})}if(!z.rendered){if(b){z.render(1)}else{return z}}var g=b?"show":"hide",h=t[g],j=E.is(":visible"),k=!c||t[g].target.length<2||H.target[0]===c.target,l=t.position,m=t.content,o,p;(typeof b).search("boolean|number")&&(b=!j);if(!E.is(":animated")&&j===b&&k){return z}if(c){if(/over|enter/.test(c.type)&&/out|leave/.test(H.event.type)&&c.target===t.show.target[0]&&E.has(c.relatedTarget).length){return z}H.event=a.extend({},c)}p=a.Event("tooltip"+g),p.originalEvent=c?H.event:f,E.trigger(p,[z,90]);if(p.isDefaultPrevented()){return z}a.attr(E[0],"aria-hidden",!b),b?(H.origin=a.extend({},i),z.focus(c),a.isFunction(m.text)&&P(m.text,e),a.isFunction(m.title.text)&&O(m.title.text,e),!v&&l.target==="mouse"&&l.adjust.mouse&&(a(document).bind("mousemove.qtip",function(a){i={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),v=d),z.reposition(c),(p.solo=!!h.solo)&&a(n,h.solo).not(E).qtip("hide",p)):(clearTimeout(z.timers.show),delete H.origin,v&&!a(n+'[tracking="true"]:visible',h.solo).not(E).length&&(a(document).unbind("mousemove.qtip"),v=e),z.blur(c)),k&&E.stop(0,1),h.effect===e?(E[g](),q.call(E)):a.isFunction(h.effect)?(h.effect.call(E,z),E.queue("fx",function(a){q(),a()})):E.fadeTo(90,b?1:0,q),b&&h.target.trigger("qtip-"+w+"-inactive");return z},show:function(a){return z.toggle(d,a)},hide:function(a){return z.toggle(e,a)},focus:function(b){if(!z.rendered){return z}var c=a(n),d=parseInt(E[0].style.zIndex,10),e=g.zindex+c.length,f=a.extend({},b),h,i;E.hasClass(p)||(i=a.Event("tooltipfocus"),i.originalEvent=f,E.trigger(i,[z,e]),i.isDefaultPrevented()||(d!==e&&(c.each(function(){this.style.zIndex>d&&(this.style.zIndex=this.style.zIndex-1)}),c.filter("."+p).qtip("blur",f)),E.addClass(p)[0].style.zIndex=e));return z},blur:function(b){var c=a.extend({},b),d;E.removeClass(p),d=a.Event("tooltipblur"),d.originalEvent=c,E.trigger(d,[z]);return z},reposition:function(c,d){if(!z.rendered||C){return z}C=1;var f=t.position.target,g=t.position,j=g.my,l=g.at,m=g.adjust,n=m.method.split(" "),o=E.outerWidth(),p=E.outerHeight(),q=0,r=0,s=a.Event("tooltipmove"),u=E.css("position")==="fixed",v=g.viewport,w={left:0,top:0},x=e,y=z.plugins.tip,B={horizontal:n[0],vertical:n[1]=n[1]||n[0],enabled:v.jquery&&f[0]!==b&&f[0]!==A&&m.method!=="none",left:function(a){var b=B.horizontal==="shift",c=v.offset.left+v.scrollLeft,d=j.x==="left"?o:j.x==="right"?-o:-o/2,e=l.x==="left"?q:l.x==="right"?-q:-q/2,f=y&&y.size?y.size.width||0:0,g=y&&y.corner&&y.corner.precedance==="x"&&!b?f:0,h=c-a+g,i=a+o-v.width-c+g,k=d-(j.precedance==="x"||j.x===j.y?e:0),n=j.x==="center";b?(g=y&&y.corner&&y.corner.precedance==="y"?f:0,k=(j.x==="left"?1:-1)*d-g,w.left+=h>0?h:i>0?-i:0,w.left=Math.max(v.offset.left+(g&&y.corner.x==="center"?y.offset:0),a-k,Math.min(Math.max(v.offset.left+v.width,a+k),w.left))):(h>0&&(j.x!=="left"||i>0)?w.left-=k:i>0&&(j.x!=="right"||h>0)&&(w.left-=n?-k:k),w.left!==a&&n&&(w.left-=m.x),w.left<c&&-w.left>i&&(w.left=a));return w.left-a},top:function(a){var b=B.vertical==="shift",c=v.offset.top+v.scrollTop,d=j.y==="top"?p:j.y==="bottom"?-p:-p/2,e=l.y==="top"?r:l.y==="bottom"?-r:-r/2,f=y&&y.size?y.size.height||0:0,g=y&&y.corner&&y.corner.precedance==="y"&&!b?f:0,h=c-a+g,i=a+p-v.height-c+g,k=d-(j.precedance==="y"||j.x===j.y?e:0),n=j.y==="center";b?(g=y&&y.corner&&y.corner.precedance==="x"?f:0,k=(j.y==="top"?1:-1)*d-g,w.top+=h>0?h:i>0?-i:0,w.top=Math.max(v.offset.top+(g&&y.corner.x==="center"?y.offset:0),a-k,Math.min(Math.max(v.offset.top+v.height,a+k),w.top))):(h>0&&(j.y!=="top"||i>0)?w.top-=k:i>0&&(j.y!=="bottom"||h>0)&&(w.top-=n?-k:k),w.top!==a&&n&&(w.top-=m.y),w.top<0&&-w.top>i&&(w.top=a));return w.top-a}},D;if(a.isArray(f)&&f.length===2){l={x:"left",y:"top"},w={left:f[0],top:f[1]}}else{if(f==="mouse"&&(c&&c.pageX||H.event.pageX)){l={x:"left",y:"top"},c=(c&&(c.type==="resize"||c.type==="scroll")?H.event:c&&c.pageX&&c.type==="mousemove"?c:i&&i.pageX&&(m.mouse||!c||!c.pageX)?{pageX:i.pageX,pageY:i.pageY}:!m.mouse&&H.origin&&H.origin.pageX?H.origin:c)||c||H.event||i||{},w={top:c.pageY,left:c.pageX}}else{f==="event"?c&&c.target&&c.type!=="scroll"&&c.type!=="resize"?f=H.target=a(c.target):f=H.target:H.target=a(f),f=a(f).eq(0);if(f.length===0){return z}f[0]===document||f[0]===b?(q=h.iOS?b.innerWidth:f.width(),r=h.iOS?b.innerHeight:f.height(),f[0]===b&&(w={top:!u||h.iOS?(v||f).scrollTop():0,left:!u||h.iOS?(v||f).scrollLeft():0})):f.is("area")&&h.imagemap?w=h.imagemap(f,l,B.enabled?n:e):f[0].namespaceURI==="http://www.w3.org/2000/svg"&&h.svg?w=h.svg(f,l):(q=f.outerWidth(),r=f.outerHeight(),w=h.offset(f,g.container)),w.offset&&(q=w.width,r=w.height,x=w.flipoffset,w=w.offset);if(h.iOS<4.1&&h.iOS>3.1||h.iOS==4.3||!h.iOS&&u){D=a(b),w.left-=D.scrollLeft(),w.top-=D.scrollTop()}w.left+=l.x==="right"?q:l.x==="center"?q/2:0,w.top+=l.y==="bottom"?r:l.y==="center"?r/2:0}}w.left+=m.x+(j.x==="right"?-o:j.x==="center"?-o/2:0),w.top+=m.y+(j.y==="bottom"?-p:j.y==="center"?-p/2:0),B.enabled?(v={elem:v,height:v[(v[0]===b?"h":"outerH")+"eight"](),width:v[(v[0]===b?"w":"outerW")+"idth"](),scrollLeft:u?0:v.scrollLeft(),scrollTop:u?0:v.scrollTop(),offset:v.offset()||{left:0,top:0}},w.adjusted={left:B.horizontal!=="none"?B.left(w.left):0,top:B.vertical!=="none"?B.top(w.top):0},w.adjusted.left+w.adjusted.top&&E.attr("class",function(a,b){return b.replace(/ui-tooltip-pos-\w+/i,k+"-pos-"+j.abbreviation())}),x&&w.adjusted.left&&(w.left+=x.left),x&&w.adjusted.top&&(w.top+=x.top)):w.adjusted={left:0,top:0},s.originalEvent=a.extend({},c),E.trigger(s,[z,w,v.elem||v]);if(s.isDefaultPrevented()){return z}delete w.adjusted,d===e||isNaN(w.left)||isNaN(w.top)||f==="mouse"||!a.isFunction(g.effect)?E.css(w):a.isFunction(g.effect)&&(g.effect.call(E,z,a.extend({},w)),E.queue(function(b){a(this).css({opacity:"",height:""}),a.browser.msie&&this.style.removeAttribute("filter"),b()})),C=0;return z},redraw:function(){if(z.rendered<1||D){return z}var a=t.position.container,b,c,d,e;D=1,t.style.height&&E.css("height",t.style.height),t.style.width?E.css("width",t.style.width):(E.css("width","").addClass(r),c=E.width()+1,d=E.css("max-width")||"",e=E.css("min-width")||"",b=(d+e).indexOf("%")>-1?a.width()/100:0,d=(d.indexOf("%")>-1?b:1)*parseInt(d,10)||c,e=(e.indexOf("%")>-1?b:1)*parseInt(e,10)||0,c=d+e?Math.min(Math.max(c,e),d):c,E.css("width",Math.round(c)).removeClass(r)),D=0;return z},disable:function(b){"boolean"!==typeof b&&(b=!E.hasClass(m)&&!H.disabled),z.rendered?(E.toggleClass(m,b),a.attr(E[0],"aria-disabled",b)):H.disabled=!!b;return z},enable:function(){return z.disable(e)},destroy:function(){var b=s[0],c=a.attr(b,u),d=s.data("qtip");z.rendered&&(E.remove(),a.each(z.plugins,function(){this.destroy&&this.destroy()})),clearTimeout(z.timers.show),clearTimeout(z.timers.hide),R();if(!d||z===d){a.removeData(b,"qtip"),t.suppress&&c&&(a.attr(b,"title",c),s.removeAttr(u)),s.removeAttr("aria-describedby")}s.unbind(".qtip-"+w),delete j[z.id];return s}})}function x(b){var c;if(!b||"object"!==typeof b){return e}"object"!==typeof b.metadata&&(b.metadata={type:b.metadata});if("content" in b){if("object"!==typeof b.content||b.content.jquery){b.content={text:b.content}}c=b.content.text||e,!a.isFunction(c)&&(!c&&!c.attr||c.length<1||"object"===typeof c&&!c.jquery)&&(b.content.text=e),"title" in b.content&&("object"!==typeof b.content.title&&(b.content.title={text:b.content.title}),c=b.content.title.text||e,!a.isFunction(c)&&(!c&&!c.attr||c.length<1||"object"===typeof c&&!c.jquery)&&(b.content.title.text=e))}"position" in b&&("object"!==typeof b.position&&(b.position={my:b.position,at:b.position})),"show" in b&&("object"!==typeof b.show&&(b.show.jquery?b.show={target:b.show}:b.show={event:b.show})),"hide" in b&&("object"!==typeof b.hide&&(b.hide.jquery?b.hide={target:b.hide}:b.hide={event:b.hide})),"style" in b&&("object"!==typeof b.style&&(b.style={classes:b.style})),a.each(h,function(){this.sanitize&&this.sanitize(b)});return b}function w(){w.history=w.history||[],w.history.push(arguments);if("object"===typeof console){var a=console[console.warn?"warn":"log"],b=Array.prototype.slice.call(arguments),c;typeof arguments[0]==="string"&&(b[0]="qTip2: "+b[0]),c=a.apply?a.apply(console,b):a(b)}}"use strict";var d=!0,e=!1,f=null,g,h,i,j={},k="ui-tooltip",l="ui-widget",m="ui-state-disabled",n="div.qtip."+k,o=k+"-default",p=k+"-focus",q=k+"-hover",r=k+"-fluid",s="-31000px",t="_replacedByqTip",u="oldtitle",v;g=a.fn.qtip=function(b,h,i){var j=(""+b).toLowerCase(),k=f,l=j==="disable"?[d]:a.makeArray(arguments).slice(1),m=l[l.length-1],n=this[0]?a.data(this[0],"qtip"):f;if(!arguments.length&&n||j==="api"){return n}if("string"===typeof b){this.each(function(){var b=a.data(this,"qtip");if(!b){return d}m&&m.timeStamp&&(b.cache.event=m);if(j!=="option"&&j!=="options"||!h){b[j]&&b[j].apply(b[j],l)}else{if(a.isPlainObject(h)||i!==c){b.set(h,i)}else{k=b.get(h);return e}}});return k!==f?k:this}if("object"===typeof b||!arguments.length){n=x(a.extend(d,{},b));return g.bind.call(this,n,m)}},g.bind=function(b,f){return this.each(function(k){function r(b){function d(){p.render(typeof b==="object"||l.show.ready),m.show.add(m.hide).unbind(o)}if(p.cache.disabled){return e}p.cache.event=a.extend({},b),p.cache.target=b?a(b.target):[c],l.show.delay>0?(clearTimeout(p.timers.show),p.timers.show=setTimeout(d,l.show.delay),n.show!==n.hide&&m.hide.bind(n.hide,function(){clearTimeout(p.timers.show)})):d()}var l,m,n,o,p,q;q=a.isArray(b.id)?b.id[k]:b.id,q=!q||q===e||q.length<1||j[q]?g.nextid++:j[q]=q,o=".qtip-"+q+"-create",p=z.call(this,q,b);if(p===e){return d}l=p.options,a.each(h,function(){this.initialize==="initialize"&&this(p)}),m={show:l.show.target,hide:l.hide.target},n={show:a.trim(""+l.show.event).replace(/ /g,o+" ")+o,hide:a.trim(""+l.hide.event).replace(/ /g,o+" ")+o},/mouse(over|enter)/i.test(n.show)&&!/mouse(out|leave)/i.test(n.hide)&&(n.hide+=" mouseleave"+o),m.show.bind("mousemove"+o,function(a){i={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),m.show.bind(n.show,r),(l.show.ready||l.prerender)&&r(f)})},h=g.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,"center").toLowerCase(),this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(a.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.precedance=a.charAt(0).search(/^(t|b)/)>-1?"y":"x",this.string=function(){return this.precedance==="y"?this.y+this.x:this.x+this.y},this.abbreviation=function(){var a=this.x.substr(0,1),b=this.y.substr(0,1);return a===b?a:a==="c"||a!=="c"&&b!=="c"?b+a:a+b}},offset:function(a,b){function i(a,b){c.left+=b*a.scrollLeft(),c.top+=b*a.scrollTop()}var c=a.offset(),d=b,e=0,f=document.body,g,h;if(d){do{d.css("position")!=="static"&&(g=d[0]===f?{left:parseInt(d.css("left"),10)||0,top:parseInt(d.css("top"),10)||0}:d.position(),c.left-=g.left+(parseInt(d.css("borderLeftWidth"),10)||0)+(parseInt(d.css("marginLeft"),10)||0),c.top-=g.top+(parseInt(d.css("borderTopWidth"),10)||0),h=d.css("overflow"),(h==="scroll"||h==="auto")&&++e);if(d[0]===f){break}}while(d=d.offsetParent());b[0]!==f&&e&&i(b,1)}return c},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_","."))||e,fn:{attr:function(b,c){if(this.length){var d=this[0],e="title",f=a.data(d,"qtip");if(b===e&&f&&"object"===typeof f&&f.options.suppress){if(arguments.length<2){return a.attr(d,u)}f&&f.options.content.attr===e&&f.cache.attr&&f.set("content.text",c);return this.attr(u,c)}}return a.fn["attr"+t].apply(this,arguments)},clone:function(b){var c=a([]),d="title",e=a.fn["clone"+t].apply(this,arguments);b||e.filter("["+u+"]").attr("title",function(){return a.attr(this,u)}).removeAttr(u);return e},remove:a.ui?f:function(b,c){a(this).each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add(this).each(function(){a(this).triggerHandler("remove")})})}}},a.each(h.fn,function(b,c){if(!c||a.fn[b+t]){return d}var e=a.fn[b+t]=a.fn[b];a.fn[b]=function(){return c.apply(this,arguments)||e.apply(this,arguments)}}),g.version="nightly",g.nextid=0,g.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),g.zindex=15000,g.defaults={prerender:e,id:e,overwrite:d,suppress:d,content:{text:d,attr:"title",title:{text:e,button:e}},position:{my:"top left",at:"bottom right",target:e,container:e,viewport:e,adjust:{x:0,y:0,mouse:d,resize:d,method:"flip flip"},effect:function(b,c,d){a(this).animate(c,{duration:200,queue:e})}},show:{target:e,event:"mouseenter",effect:d,delay:90,solo:e,ready:e,autofocus:e},hide:{target:e,event:"mouseleave",effect:d,delay:0,fixed:e,inactive:e,leave:"window",distance:e},style:{classes:"",widget:e,width:e,height:e},events:{render:f,move:f,show:f,hide:f,toggle:f,visible:f,focus:f,blur:f}},h.tip=function(a){var b=a.plugins.tip;return"object"===typeof b?b:a.plugins.tip=new B(a)},h.tip.initialize="render",h.tip.sanitize=function(a){var b=a.style,c;b&&"tip" in b&&(c=a.style.tip,typeof c!=="object"&&(a.style.tip={corner:c}),/string|boolean/i.test(typeof c.corner)||(c.corner=d),typeof c.width!=="number"&&delete c.width,typeof c.height!=="number"&&delete c.height,typeof c.border!=="number"&&c.border!==d&&delete c.border,typeof c.offset!=="number"&&delete c.offset)},a.extend(d,g.defaults,{style:{tip:{corner:d,mimic:e,width:6,height:6,border:d,offset:0}}})})(jQuery,window);jQuery.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};(function($){$.fn.dcDrilldown=function(options){var defaults={classWrapper:"dd-wrapper",classMenu:"dd-menu",classParent:"dd-parent",classParentLink:"dd-parent-a",classActive:"active",classHeader:"dd-header",eventType:"click",hoverDelay:300,speed:"slow",saveState:true,showCount:false,classCount:"dd-count",classIcon:"dd-icon ui-icon ui-icon-circle-triangle-e",linkType:"backlink",resetText:"All",headerTag:"h3",defaultText:"Select Option",includeHdr:true};var options=$.extend(defaults,options);return this.each(function(options){var $dcDrilldownObj=this;$($dcDrilldownObj).addClass(defaults.classMenu);var $wrapper='<div class="'+defaults.classWrapper+'" />';$($dcDrilldownObj).wrap($wrapper);var $dcWrapper=$($dcDrilldownObj).parent();var objIndex=$($dcWrapper).index("."+defaults.classWrapper);var idHeader=defaults.classHeader+"-"+objIndex;var idWrapper=defaults.classWrapper+"-"+objIndex;$($dcWrapper).attr("id",idWrapper);var $header='<div id="'+idHeader+'" class="'+defaults.classHeader+'"></div>';setUpDrilldown();if(defaults.saveState==true){var cookieId=defaults.classWrapper+"-"+objIndex;checkCookie(cookieId,$dcDrilldownObj)}resetDrilldown($dcDrilldownObj,$dcWrapper);$("li a",$dcDrilldownObj).click(function(e){$link=this;$activeLi=$(this).parent("li").stop();$siblingsLi=$($activeLi).siblings();if($("> ul",$activeLi).length){if($($link).hasClass(defaults.classActive)){$("ul a",$activeLi).removeClass(defaults.classActive);resetDrilldown($dcDrilldownObj,$dcWrapper)}else{actionDrillDown($activeLi,$dcWrapper,$dcDrilldownObj)}}if($(this).next("ul").length>0){e.preventDefault()}});function setUpDrilldown(){$arrow='<span class="'+defaults.classIcon+'"></span>';$($dcDrilldownObj).before($header);var totalWidth=$($dcDrilldownObj).outerWidth();if(totalWidth==0){totalWidth=200}totalWidth+="px";var itemHeight=$("li:first",$dcDrilldownObj).height();if(itemHeight==0){itemHeight=38}var objUl=$("ul",$dcDrilldownObj.parentNode);var maxItems=findMaxHeight(objUl);var maxUl=$(objUl+'[rel="'+maxItems+'"]');var getIndex=findMaxIndex(maxUl);if(defaults.linkType=="link"){menuHeight=itemHeight*(maxItems+getIndex)}else{menuHeight=itemHeight*maxItems}$($dcDrilldownObj).css({height:menuHeight+"px",width:totalWidth});$("li",$dcDrilldownObj).each(function(){$(this).css({width:totalWidth});$("ul",this).css({width:totalWidth,marginRight:"-"+totalWidth,marginTop:"0"});if($("> ul",this).length){$(this).addClass(defaults.classParent);$("> a",this).addClass(defaults.classParentLink).append($arrow);if(defaults.showCount==true){var parentLink=$("a:not(."+defaults.classParentLink+")",this);var countParent=parseInt($(parentLink).length);getCount=countParent;$("> a",this).append(' <span class="'+defaults.classCount+'">('+getCount+")</span>")}}});$($dcDrilldownObj).find("li").hover(function(){$(this).addClass("ui-state-highlight")},function(){$(this).removeClass("ui-state-highlight")});$("ul",$dcWrapper).each(function(){$("li:last",this).addClass("last")});$("> ul > li:last",$dcWrapper).addClass("last");if(defaults.linkType=="link"){$(objUl).css("top",itemHeight+"px")}}$("#"+idHeader+" a").live("click",function(e){if($(this).hasClass("link-back")){linkIndex=$("#"+idWrapper+" ."+defaults.classParentLink+".active").length;linkIndex=linkIndex-2;$("a."+defaults.classActive+":last",$dcDrilldownObj).removeClass(defaults.classActive)}else{var linkIndex=parseInt($(this).index("#"+idHeader+" a"));if(linkIndex==0){$("a",$dcDrilldownObj).removeClass(defaults.classActive)}else{linkIndex=linkIndex-1;$("a."+defaults.classActive+":gt("+linkIndex+")",$dcDrilldownObj).removeClass(defaults.classActive)}}resetDrilldown($dcDrilldownObj,$dcWrapper);e.preventDefault()})});function findMaxHeight(element){var maxValue=undefined;$(element).each(function(){var val=parseInt($("> li",this).length);$(this).attr("rel",val);if(maxValue===undefined||maxValue<val){maxValue=val}});return maxValue}function findMaxIndex(element){var maxIndex=undefined;$(element).each(function(){var val=parseInt($(this).parents("li").length);if(maxIndex===undefined||maxIndex<val){maxIndex=val}});return maxIndex}function checkCookie(cookieId,obj){var cookieVal=$.cookie(cookieId);if(cookieVal!=null){var activeArray=cookieVal.split(",");$.each(activeArray,function(index,value){var $cookieLi=$("li:eq("+value+")",obj);$("> a",$cookieLi).addClass(defaults.classActive)})}}function actionDrillDown(element,wrapper,obj){element.unbind("mouseenter mouseleave");element.removeClass("ui-state-highlight");element.find("li").hover(function(){$(this).addClass("ui-state-highlight")},function(){$(this).removeClass("ui-state-highlight")});var $header=$("."+defaults.classHeader,wrapper);var getNewBreadcrumb=$("h3",$header).html();var getNewHeaderText=$("> a",element).html();if(defaults.linkType=="breadcrumb"){if(!$("ul",$header).length){$($header).prepend("<ul></ul>")}if(getNewBreadcrumb==defaults.defaultText){$("ul",$header).append('<li><a href="#" class="first">'+defaults.resetText+"</a></li>")}else{$("ul",$header).append('<li><a href="#">'+getNewBreadcrumb+"</a></li>")}}if(defaults.linkType=="backlink"){if(!$("a",$header).length){$($header).prepend('<a href="#" class="link-back">'+getNewBreadcrumb+"</a>")}else{$(".link-back",$header).html(getNewBreadcrumb)}}if(defaults.linkType=="link"){if(!$("a",$header).length){$($header).prepend('<ul><li><a href="#" class="first">'+defaults.resetText+"</a></li></ul>")}}updateHeader($header,getNewHeaderText);var activeLink=$("> a",element);$(activeLink).addClass(defaults.classActive);$("> ul li",element).show();$("> ul",element).animate({"margin-right":0},defaults.speed);var $siblingsLi=$(element).siblings();$($siblingsLi).hide();if(defaults.linkType!="link"){$(activeLink).hide()}if(defaults.saveState==true){var cookieId=$(wrapper).attr("id");createCookie(cookieId,obj)}}function actionDrillUp(element,obj,wrapper){var $header=$("."+defaults.classHeader,wrapper);var activeLink=$("> a",element);var checklength=$("."+defaults.classActive,wrapper).length;var activeIndex=$(activeLink).index("."+defaults.classActive,wrapper);var totalWidth=$(obj).outerWidth(true);$("ul",element).css("margin-right",-totalWidth+"px");$(activeLink).addClass(defaults.classActive);$("> ul li",element).show();$("a",element).show();var getNewHeaderText=$("> a",element).html();$("h3",$header).html(getNewHeaderText);if(defaults.linkType=="breadcrumb"){var breadcrumbIndex=activeIndex-1;$("a:gt("+activeIndex+")",$header).remove()}}function updateHeader(obj,html){if(defaults.includeHdr==true){if($("h3",obj).length){$("h3",obj).html(html);$("h3",obj).children("span").removeClass("ui-icon ui-icon-circle-triangle-e")}else{$(obj).append("<"+defaults.headerTag+">"+html+"</"+defaults.headerTag+">")}}}function resetDrilldown(obj,wrapper){var $header=$("."+defaults.classHeader,wrapper);$("ul",$header).remove();$("a",$header).remove();$("li",obj).show();$("a",obj).show();var totalWidth=$(obj).outerWidth(true);if(defaults.linkType=="link"){if($("a."+defaults.classActive+":last",obj).parent("li").length){var lastActive=$("a."+defaults.classActive+":last",obj).parent("li");$("ul",lastActive).css("margin-right",-totalWidth+"px")}else{$("ul",obj).css("margin-right",-totalWidth+"px")}}else{$("ul",obj).css("margin-right",-totalWidth+"px")}updateHeader($header,defaults.defaultText);if(defaults.saveState==true){var cookieId=$(wrapper).attr("id");createCookie(cookieId,obj)}$("a."+defaults.classActive,obj).each(function(i){var $activeLi=$(this).parent("li").stop();actionDrillDown($activeLi,wrapper,obj)})}function createCookie(cookieId,obj){var activeIndex=[];$("a."+defaults.classActive,obj).each(function(i){var $arrayItem=$(this).parent("li");var itemIndex=$("li",obj).index($arrayItem);activeIndex.push(itemIndex)});$.cookie(cookieId,activeIndex,{path:"/"})}}})(jQuery);(function($){$.fn.themeswitcher=function(options){var switcherDiv=this,switcherOptions={};var settings={loadtheme:"",height:400,width:250,rounded:true,imgpath:"",themepath:"http://ajax.googleapis.com/ajax/libs/jqueryui/",jqueryuiversion:"1.8.10",initialtext:"Switch Theme",buttonpretext:"Theme:",closeonselect:true,buttonheight:14,cookiename:"jquery-ui-theme",themes:[],additionalthemes:[],onopen:null,onclose:null,onselect:null,cookieexpires:365,cookiepath:"/"};if(options){$.each(options,function(k,v){switcherOptions[k.toLowerCase()]=v});$.extend(settings,switcherOptions)}if(!settings.themes.length){var themes=[{title:"Black Tie",name:"black-tie",icon:"theme_90_black_tie.png"},{title:"Blitzer",name:"blitzer",icon:"theme_90_blitzer.png"},{title:"Cupertino",name:"cupertino",icon:"theme_90_cupertino.png"},{title:"Dark Hive",name:"dark-hive",icon:"theme_90_dark_hive.png"},{title:"Dot Luv",name:"dot-luv",icon:"theme_90_dot_luv.png"},{title:"Eggplant",name:"eggplant",icon:"theme_90_eggplant.png"},{title:"Excite Bike",name:"excite-bike",icon:"theme_90_excite_bike.png"},{title:"Flick",name:"flick",icon:"theme_90_flick.png"},{title:"Hot Sneaks",name:"hot-sneaks",icon:"theme_90_hot_sneaks.png"},{title:"Humanity",name:"humanity",icon:"theme_90_humanity.png"},{title:"Le Frog",name:"le-frog",icon:"theme_90_le_frog.png"},{title:"Mint Choc",name:"mint-choc",icon:"theme_90_mint_choco.png"},{title:"Overcast",name:"overcast",icon:"theme_90_overcast.png"},{title:"Pepper Grinder",name:"pepper-grinder",icon:"theme_90_pepper_grinder.png"},{title:"Redmond",name:"redmond",icon:"theme_90_windoze.png"},{title:"Smoothness",name:"smoothness",icon:"theme_90_smoothness.png"},{title:"South Street",name:"south-street",icon:"theme_90_south_street.png"},{title:"Start",name:"start",icon:"theme_90_start_menu.png"},{title:"Sunny",name:"sunny",icon:"theme_90_sunny.png"},{title:"Swanky Purse",name:"swanky-purse",icon:"theme_90_swanky_purse.png"},{title:"Trontastic",name:"trontastic",icon:"theme_90_trontastic.png"},{title:"UI Darkness",name:"ui-darkness",icon:"theme_90_ui_dark.png"},{title:"UI Lightness",name:"ui-lightness",icon:"theme_90_ui_light.png"},{title:"Vader",name:"vader",icon:"theme_90_black_matte.png"}]}else{var themes=settings.themes}if(settings.additionalthemes.length){$.extend(themes,settings.additionalthemes)}var switcherLinkStyle={cursor:"pointer","font-family":"'Trebuchet MS', Verdana, sans-serif","font-size":"11px",color:"#666",background:"#eee url("+settings.imgpath+"buttonbg.png) repeat-x 50% 50%",border:"1px solid #CCC","text-decoration":"none",padding:"3px 3px 3px 8px",width:settings.width+"px",display:"block",height:settings.buttonheight+"px",outline:"0px","line-height":settings.buttonheight+"px"};var switcherLink=$("<a/>").addClass("jquery-ui-switcher-link").css(switcherLinkStyle).bind({click:function(){(!switcherDiv.find(".jquery-ui-switcher-list-hldr").is(":visible"))?openSwitcher():closeSwitcher()}});var switcherTitle=$("<span/>").addClass("jquery-ui-switcher-title").appendTo(switcherLink);$("<span/>").addClass("jquery-ui-switcher-arrow").css({"float":"right",width:"16px",height:"16px",background:"url("+settings.imgpath+"icon_color_arrow.gif) no-repeat 50% 50%"}).appendTo(switcherLink);if($.cookie(settings.cookiename)){updateTheme(findTheme($.cookie(settings.cookiename)))}else{if(settings.loadtheme.length){updateTheme(findTheme(settings.loadtheme))}else{switcherTitle.text(settings.initialtext)}}var switcherListHldr=$("<div/>").addClass("jquery-ui-switcher-list-hldr").css({width:eval(settings.width+8)+"px","border-top":"none","z-index":"999999",position:"absolute",top:eval(settings.buttonheight+3)+"px",left:"0px",display:"none"}).bind({mouseleave:function(){closeSwitcher()}});var switcherList=$("<ul/>").css({"list-style":"none",margin:"0",padding:"0","overflow-y":"auto","overflow-x":"hidden",height:settings.height+"px"}).appendTo(switcherListHldr);$.each(themes,function(k,v){var listItem=$("<li>").appendTo(switcherList);var listLink=$("<a>").css({display:"block","text-decoration":"none","float":"left",width:"100%",clear:"left"}).bind({mouseenter:function(){$(this).addClass("ui-state-highlight")},mouseleave:function(){$(this).removeClass("ui-state-highlight")},click:function(e){updateTheme($(this).data());e.preventDefault()}}).attr("href","#").data(v).appendTo(listItem);var linkImg=$("<img>").attr("src",settings.imgpath+v.icon).attr("title",v.title).css({"float":"left","margin-right":"5px"}).appendTo(listLink);var linkText=$("<span>").css({"float":"left","padding-top":"5px"}).text(v.title).appendTo(listLink)});function updateTheme(data){if(settings.onselect!==null){settings.onselect()}switcherTitle.text(settings.buttonpretext+" "+data.title);var currentStyle=[];var url=data.url;if(!url){var urlPrefix=settings.themepath+settings.jqueryuiversion+"/themes/";url=urlPrefix+data.name+"/jquery-ui.css";currentStyle=$('link[href^="'+urlPrefix+'"]').first()}if(currentStyle.length){currentStyle[0].href=url}else{var style=$("<link/>").attr("type","text/css").attr("rel","stylesheet").attr("href",url);style.appendTo("head")}$.cookie(settings.cookiename,data.name,{expires:settings.cookieexpires,path:settings.cookiepath});switcherDiv.find(".jquery-ui-switcher-title").text(settings.buttonpretext+" "+data.title);if(settings.closeonselect){closeSwitcher()}}function findTheme(theme){var result=null;$.each(themes,function(k,v){if(v.name.toLowerCase()===theme.toLowerCase()||v.title.toLowerCase()===theme.toLowerCase()){result=v;return false}});if(!result){return themes[0]}return result}function openSwitcher(){if(settings.onopen!==null){settings.onopen()}switcherDiv.find(".jquery-ui-switcher-list-hldr").slideDown("fast")}function closeSwitcher(){if(settings.onclose!==null){settings.onclose()}switcherDiv.find(".jquery-ui-switcher-list-hldr").slideUp("fast")}this.css("position","relative");this.append(switcherLink);this.append(switcherListHldr);return this}})(jQuery);
/*
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function($){$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1}if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days)}value=String(value);return(document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join(""))}options=value||{};var decode=options.raw?function(s){return s}:decodeURIComponent;var pairs=document.cookie.split("; ");for(var i=0,pair;pair=pairs[i]&&pairs[i].split("=");i++){if(decode(pair[0])===key){return decode(pair[1]||"")}}return null}})(jQuery);function browserCheck(){if(window.File){}else{}if(Modernizr.localstorage){}else{}if(checkVersion()==false){$("#BrowserCheck").append("<p>Warning: The State Diagram Generator does not work properly with this version of Internet Explorer<p>");$("#BrowserCheck").append('<p>Note: The <a href="../Home/Download"> Finite State Machine Source Code Generators</a> are *not* affected by these browsers imcompatibilities.<p>')}}function getInternetExplorerVersion(){var rv=-1;if(navigator.appName=="Microsoft Internet Explorer"){var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(re.exec(ua)!=null){rv=parseFloat(RegExp.$1)}}return rv}function checkVersion(){var msg="You're not using Internet Explorer.";var ver=getInternetExplorerVersion();var ok=true;if(ver>-1){if(ver>=8){msg="You're using a recent copy of Internet Explorer."}else{msg="You should upgrade your copy of Internet Explorer.";ok=false}}return ok};function StateMachineModel(){var _valid=false;var _states=[];var _xmlContent;var _domDocument;var _name;var _fileName;var $xml;var _xslDom;this.getXmlContent=function(){return _xmlContent};this.getXml=function(){return $xml};this.isValid=function(){return _valid};this.getStateRoot=function(){return $xml.find("state:first")};this.getName=function(){if(_name){return _name}};this.getLanguage=function(){var language="";var stateMachineRoot=_domDocument.firstChild;if(stateMachineRoot==undefined){throw"Cannot find the root element StateMachine"}else{var namespace=stateMachineRoot.namespaceURI;if(namespace.indexOf("DotNet")!=1){language="dotnet"}else{if(namespace.indexOf("Cpp")!=1){language="cpp"}else{if(namespace.indexOf("Java")!=1){language="java"}}}}return language};this.setName=function(name){_name=name};this.setFilename=function(filename){_fileName=filename};this.getStateName=function($state){var stateName=$state.attr("name");if(stateName){return stateName}else{throw"State must have the name attribute"}};this.setStateName=function($state,name){$state.attr("name",name)};this.stateRename=function(nameOld,nameNew){var $stateOld=this._getState(nameOld);$stateOld.attr("name",nameNew);var $transitions=this.getTransitionPointingToState(nameOld);$transitions.attr("nextState",nameNew)};this.getTransitionPointingToState=function(stateName){var $transitions=$xml.find("transition[nextState="+stateName+"]");return $transitions};this.getStateKind=function(stateName){var $state=this._getState(stateName);var kind=$state.attr("kind");return kind};this.setStateKind=function(stateName,kind){var $state=this._getState(stateName);if(kind&&kind!="Leaf"){$state.attr("kind",kind)}else{$state.removeAttr("kind")}};this.getState=function(stateName){var $state=$xml.find("state[name="+stateName+"]");return $state};this.hasState=function(stateName){if(this.getState(stateName).size()==0){return false}else{return true}};this._getEventId=function(eventId){var $eventId=$xml.find("event[id="+eventId+"],timer[id="+eventId+"]");return $eventId};this.hasEventId=function(eventId){if(this._getEventId(eventId).size()==0){return false}else{return true}};this._getEventName=function(eventName){var $eventName=$xml.find("event[name="+eventName+"],timer[name="+eventName+"]");return $eventName};this.hasEventName=function(eventName){if(this._getEventName(eventName).size()==0){return false}else{return true}};this.getEventIdList=function(){var eventIdList=[];$xml.find("event[id],timer[id]").each(function(){eventIdList.push($(this).attr("id"))});return eventIdList};this.getTimerNameList=function(){var timerNameList=[];$xml.find("timer[name]").each(function(){timerNameList.push($(this).attr("name"))});return timerNameList};this.getStateNameList=function(){var stateNameList=[];this.getStateRoot().find("state[name]").each(function(){stateNameList.push($(this).attr("name"))});return stateNameList};this.getNextStateNameList=function(stateName){var stateNameList=[];this._getNextStateAll(_states[stateName].context,stateNameList);return stateNameList};this._getNextStateAll=function(context,stateNameList){if(context){var states=context.states;for(var stateName in states){if(this.isStateRoot(stateName)==false){stateNameList.push(stateName)}}this._getNextStateAll(context.parent,stateNameList)}};this.getTransitionNextState=function($transition){return $transition.attr("nextState")};this.getTransitionEvent=function($transition){var event=$transition.attr("event");return event};this.getTransitionName=function($transition){var transitionName;var condition=this.getCondition($transition);if(condition){transitionName=this.getTransitionEvent($transition)+'[<span class="actionContent">'+condition+"</span>]"}else{transitionName=this.getTransitionEvent($transition)}return transitionName};this.getCondition=function($transition){var conditionAttribute=$transition.attr("condition");if(conditionAttribute){return conditionAttribute}var conditionElement=$transition.children("condition:first").text();if(conditionElement!=""){return conditionElement}return null};this.getChildList=function($state){return $state.children("state")};this.hasChild=function(stateName){return this.getState(stateName).children("state,parallel").size()>0?true:false};this.getParallel=function(stateName){return this.getState(stateName).children("parallel:first")};this.getParallelNextState=function($parallel){return $parallel.attr("nextState")};this.hasParallel=function(stateName){return this.getState(stateName).children("parallel:first").size()>0?true:false};this.getTransitionList=function($state){return $state.children("transition")};this.getTransition=function(stateName,transitionIndex){return this.getState(stateName).children("transition:eq("+transitionIndex+")")};this.getOnEntry=function($state){return $state.children("onEntry:first")};this.getOnExit=function($state){return $state.children("onExit:first")};this.getTimerName=function($timerTag){return $timerTag.attr("timer")};this.getActionInAttribute=function($node){var actionInAttribute=$node.attr("action");return actionInAttribute};this.hasActionInAttribute=function($node){var found=false;$node.each(function(){if($(this).attr("action")){found=true}});return found};this.hasStateAction=function($state){var $transitions=$state.children("transition");return this.hasAction($transitions)};this.hasAction=function($node){if(this.hasActionInAttribute($node)){return true}if($node.children("action,timerStart,timerStop").size()>0){return true}else{return false}};this._hasTransition=function($state){if($state.children("transition").size()>0){return true}else{return false}};this.xmlToDom=function(xml){_valid=false;if(xml==undefined){return}try{$("#XmlErrors").children().remove();_domDocument=jQuery.parseXML(xml);$xml=$(_domDocument);_xmlContent=xml}catch(e){throw"Error parsing state machine"}return _parse($xml)};this.domToXml=function(){if($xml==undefined){return}var domNotPretty=$xml.context;var serializer;if(typeof XSLTProcessor!="undefined"){var xsltProcessor=new XSLTProcessor();if(_xslDom==undefined){_xslDom=this.loadXMLDoc("indent.xsl")}xsltProcessor.importStylesheet(_xslDom);var domPretty=xsltProcessor.transformToDocument(domNotPretty);serializer=new XMLSerializer();_xmlContent=serializer.serializeToString(domPretty)}else{if(window.ActiveXObject){var xslt=new ActiveXObject("Msxml2.XSLTemplate");var xmlDoc=new ActiveXObject("Msxml2.DOMDocument");if(_xslDom==undefined){_xslDom=new ActiveXObject("Msxml2.FreeThreadedDOMDocument");_xslDom.async=false;_xslDom.load("indent.xsl");if(_xslDom.parseError.errorCode!=0){var myErr=xmlDoc.parseError;return}}xslt.stylesheet=_xslDom;var xslProc=xslt.createProcessor();xslProc.input=domNotPretty;xslProc.transform();_xmlContent=xslProc.output}else{if(stateEditorMainWindow){var serializer=new XMLSerializer();_xmlContent=stateEditorMainWindow.indentXml(serializer.serializeToString(domNotPretty))}else{var serializer=new XMLSerializer();_xmlContent=serializer.serializeToString(domNotPretty)}}}this.xmlToDom(_xmlContent);return _xmlContent};this.loadXMLDoc=function(dname){var xhttp;if(window.XMLHttpRequest){xhttp=new XMLHttpRequest()}else{xhttp=new ActiveXObject("Microsoft.XMLHTTP")}xhttp.open("GET",dname,false);xhttp.send("");return xhttp.responseXML};function _parse($xml){var $stateMachine=$xml.children('[nodeName="sm:StateMachine"]');if($stateMachine.size()!=1){throw"Unable to find the root node sm:StateMachine, check the input file"}_parseSettings($stateMachine);_parseStates($stateMachine);_valid=true}function _parseSettings($stateMachine){var $settings=$stateMachine.find("settings").first();if($settings.size()>0){_parseSettingsAttribute($settings);_parseSettingsElement($settings)}else{throw"settings tag not found"}}function _parseStates($stateMachine){_states=[];var $stateRoot=$stateMachine.children("state");if($stateRoot.size()==0){throw"Unable to find the root state"}else{if($stateRoot.size()>1){throw"Only one root state is allowed"}else{parseState($stateRoot,null,null,new Context(null))}}}function parseState($state,$stateParent,$stateParallel,context){var stateName=$state.attr("name");var state=_states[stateName];if(state){throw"State "+stateName+" already exist"}_states[stateName]=new State($state,$stateParent,$stateParallel,context);var $parallel=$state.children("parallel").first();if($parallel.size()==0){$state.children("state").each(function(){parseState($(this),$state,$stateParallel,context)})}else{$parallel.children("state").each(function(){var contextSub=new Context(context);parseState($(this),null,$state,contextSub)})}}function _parseSettingsAttribute($settings){var name=$settings.attr(name);if(name){this.setName(name)}}function _parseSettingsElement(settings){}this.getFirstElement=function($node,elementName){return $node.children(elementName+":first")};this.isStateRoot=function(stateName){var $stateRoot=this.getStateRoot();if($stateRoot.attr("name")==stateName){return true}else{return false}};this.isStateComposite=function(stateName){var $state=this._getState(stateName);if($state.children("state").size()==0){return false}else{return true}};this.stateRemove=function(stateName){var $state=this._getState(stateName);if(this.isStateRoot(stateName)==false){$state.remove()}};this.stateAdd=function(stateNameCurrent,name,kind,where){var $stateCurrent=this._getState(stateNameCurrent);var stateNew=_domDocument.createElement("state");this.setStateName($(stateNew),name);this.setStateKind(name,kind);if(where=="before"){$stateCurrent.before(stateNew)}else{if(where=="below"){$stateCurrent.append(stateNew)}else{$stateCurrent.after(stateNew)}}};this.stateCopy=function(stateName){var $state=this._getState(stateName);return $state.clone()};this.statePaste=function(stateName,pasteAs,$copiedState){if($copiedState==undefined){return}var $state=this._getState(stateName);if(pasteAs=="before"){$copiedState.insertBefore($state)}else{if(pasteAs=="after"){$copiedState.insertAfter($state)}else{if(pasteAs=="asChild"){$state.append($copiedState)}}}};this.stateActionPaste=function(stateName,actionContainerName,$copiedAction){if($copiedAction==undefined){return}var $actionContainer=this.getActionContainer(stateName,actionContainerName,0);if($actionContainer.size()==0){$actionContainer=this.newActionContainer(stateName,actionContainerName,0)}$actionContainer.append($copiedAction)};this.removeActionContainer=function(stateName,actionContainer){var $stateName=this._getState(stateName);$stateName.children(actionContainer).remove()};this.addCode=function(stateName,actionContainerName,actionContainerIndex,actionContent,actionIndex){if(actionContent==""){return}var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);if($actionContainer.size()==0){$actionContainer=this.newActionContainer(stateName,actionContainerName,actionContainerIndex)}var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);var actionNew=_domDocument.createElement("action");$(actionNew).text(actionContent);if($action.size()==0){$actionContainer.append(actionNew)}else{$(actionNew).insertAfter($action)}};this.codeGet=function(stateName,actionContainerName,actionContainerIndex,actionIndex,attribute){if(attribute=="true"){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);return $actionContainer.attr("action")}else{var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);return $action.text()}};this.actionCopy=function(stateName,actionContainerName,actionContainerIndex,actionIndex,attribute){var $action;if(attribute=="true"){var actionContent=this.codeGet(stateName,actionContainerName,actionContainerIndex,actionIndex,attribute);var action=_domDocument.createElement("action");$(action).text(actionContent);return $(action)}else{var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);$action=$actionContainer.children(":eq("+actionIndex+")");return $action.clone()}};this.actionPaste=function(stateName,actionContainerName,actionContainerIndex,actionIndex,below,$actionToCopy){if($actionToCopy==undefined||$actionToCopy.size()==0){return}var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);if($action.size()==0){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);$actionContainer.append($actionToCopy)}else{if(below==true){$actionToCopy.insertAfter($action)}else{$actionToCopy.insertBefore($action)}}};this.editCode=function(stateName,actionContainerName,actionContainerIndex,actionContent,actionIndex,attribute){if(attribute=="true"){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);$actionContainer.attr("action",actionContent)}else{var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);$action.text(actionContent)}};this.actionRemove=function(stateName,actionContainerName,actionContainerIndex,actionIndex,attribute){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);if($actionContainer.size()==0){return}if(attribute=="true"){$actionContainer.removeAttr("action")}else{var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);$action.remove()}if(actionContainerName!="transition"){if(this.hasAction($actionContainer)==false){$actionContainer.remove()}}};this.timerStartAdd=function(stateName,actionContainerName,actionContainerIndex,actionIndex,timerName,timerDuration){if(timerDuration==""){return}var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);if($actionContainer.size()==0){$actionContainer=this.newActionContainer(stateName,actionContainerName,actionContainerIndex)}var timerStart=_domDocument.createElement("timerStart");timerStart.setAttribute("timer",timerName);timerStart.setAttribute("duration",timerDuration);var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);if($action.size()==0){$actionContainer.append(timerStart)}else{$(timerStart).insertAfter($action)}};this.timerStartEdit=function(stateName,actionContainerName,actionContainerIndex,actionIndex,timerName,timerDuration){var $timerStart=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);$timerStart.attr("timer",timerName);$timerStart.attr("duration",timerDuration)};this.timerStartGetName=function(stateName,actionContainerName,actionContainerIndex,actionIndex){var $timerStart=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);return $timerStart.attr("timer")};this.timerGetDuration=function(stateName,actionContainerName,actionContainerIndex,actionIndex){var $timerStart=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);return $timerStart.attr("duration")};this.timerStopAdd=function(stateName,actionContainerName,actionContainerIndex,actionIndex,timerName){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);if($actionContainer.size()==0){$actionContainer=this.newActionContainer(stateName,actionContainerName,actionContainerIndex)}var timerStop=_domDocument.createElement("timerStop");timerStop.setAttribute("timer",timerName);var $action=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);if($action.size()==0){$actionContainer.append(timerStop)}else{$(timerStop).insertAfter($action)}};this.timerStopEdit=function(stateName,actionContainerName,actionContainerIndex,actionIndex,timerName){var $timerStop=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);$timerStop.attr("timer",timerName)};this.timerStopGetName=function(stateName,actionContainerName,actionContainerIndex,actionIndex){var $timerStop=this.getAction(stateName,actionContainerName,actionContainerIndex,actionIndex);return $timerStop.attr("timer")};this.getTransitionCount=function(stateName){var $state=this._getState(stateName);var count=$state.children("transition").size();return count};this.transitionAdd=function(stateName,transitionIndex,event,condition,nextState){var $state=this._getState(stateName);var transition=_domDocument.createElement("transition");transition.setAttribute("event",event);if(condition!=""){transition.setAttribute("condition",condition)}else{transition.removeAttribute("condition")}if(nextState!=""){transition.setAttribute("nextState",nextState)}else{transition.removeAttribute("nextState")}var $transitionCurrent=$state.children("transition:eq("+transitionIndex+")");if($transitionCurrent.size()==1){$transitionCurrent.after($(transition))}else{var $stateChildFirst=$state.children("state:first");if($stateChildFirst.size()==0){$state.append($(transition))}else{$(transition).insertBefore($stateChildFirst)}}};this.transitionEdit=function(stateName,transitionIndex,event,condition,nextState){var $transition=this.getActionContainer(stateName,"transition",transitionIndex);$transition.attr("event",event);if(condition!=""){$transition.attr("condition",condition)}else{$transition.removeAttr("condition")}if(nextState!=""){$transition.attr("nextState",nextState)}else{$transition.removeAttr("nextState")}};this.transitionRemove=function(stateName,transitionIndex){var $transition=this.getActionContainer(stateName,"transition",transitionIndex);$transition.remove()};this.transitionCopy=function(stateName,transitionIndex){var $actionContainer=this.getActionContainer(stateName,"transition",transitionIndex);return $actionContainer.clone()};this.transitionPaste=function(stateName,transitionIndex,below,$copiedTransition){if($copiedTransition==undefined||$copiedTransition.size()==0){return}var $actionContainer=this.getActionContainer(stateName,"transition",transitionIndex);if($actionContainer.size()==0){var $state=this._getState(stateName);$state.append($copiedTransition)}else{if(below==true){$copiedTransition.insertAfter($actionContainer)}else{$copiedTransition.insertBefore($actionContainer)}}};this._getState=function(stateName){return $xml.find("state[ name = "+stateName+" ]")};this.getActionContainer=function(stateName,actionContainerName,actionContainerIndex){var $state=this._getState(stateName);var $actionContainer=$state.children(actionContainerName+":eq("+actionContainerIndex+")");return $actionContainer};this.newActionContainer=function(stateName,actionContainerName,actionContainerIndex){var actionContainerNew=_domDocument.createElement(actionContainerName);var $stateCurrent=this._getState(stateName);if(actionContainerName=="onEntry"){$stateCurrent.prepend(actionContainerNew)}else{if(actionContainerName=="onExit"){var $onEntry=$stateCurrent.children("onEntry").last();if($onEntry.size()>0){$onEntry.after(actionContainerNew)}else{$stateCurrent.prepend(actionContainerNew)}}else{if(actionContainerName=="transition"){$stateCurrent.append(actionContainerNew)}}}var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);return $actionContainer};this.getAction=function(stateName,actionContainerName,actionContainerIndex,actionIndex){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);var $action=$actionContainer.children(":eq("+actionIndex+")");return $action};this._getTimerStart=function(stateName,actionContainerName,actionContainerIndex,actionIndex){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);$timerStart=$actionContainer.children("timerStart:eq("+actionIndex+")");return $timerStart};this._getTimerStop=function(stateName,actionContainerName,actionContainerIndex,actionIndex){var $actionContainer=this.getActionContainer(stateName,actionContainerName,actionContainerIndex);$timerStop=$actionContainer.children("timerStop:eq("+actionIndex+")");return $timerStop};this.eventAdd=function(eventSourceName,eventType,eventId,params,eventName,preAction,postAction,eventIdCurrent){var $eventSource=this.getEventSource(eventSourceName);if($eventSource.size()==0){return}var $eventCurrent=this.getEvent(eventIdCurrent);var $eventNew=$(_domDocument.createElement(eventType));this.setEventParams($eventNew,params);this.setEventPreAction($eventNew,preAction);this.setEventPostAction($eventNew,postAction);$eventNew.attr("id",eventId);if(eventName!=""){$eventNew.attr("name",eventName)}if($eventCurrent.size()==0){$eventSource.prepend($eventNew)}else{$eventNew.insertAfter($eventCurrent)}return $eventNew};this.eventEdit=function(eventSourceName,eventType,eventIdUpdated,params,eventName,preAction,postAction,eventIdCurrent){var $eventNew=this.eventAdd(eventSourceName,eventType,eventIdUpdated,params,eventName,preAction,postAction,eventIdCurrent);$eventNew.prev().remove();var $transitions=$xml.find("transition[event="+eventIdCurrent+"]");$transitions.attr("event",eventIdUpdated)};this.eventSourceAdd=function(eventSourceNameCurrent,eventSourceName){var $eventSource=this.getEventSource(eventSourceName);if($eventSource.size()!=0){return}var $eventSource=$(_domDocument.createElement("eventSource"));$eventSource.attr("name",eventSourceName);var $eventSourceCurrent=this.getEventSource(eventSourceNameCurrent);if($eventSourceCurrent.size()==0){var $events=this.getEvents();$events.prepend($eventSource)}else{$eventSource.insertAfter($eventSourceCurrent)}this.eventAdd(eventSourceName,"event","eventToEdit","","","")};this.eventSourceEdit=function(eventSourceOld,eventSourceNameNew){var $eventSource=this.getEventSource(eventSourceOld);$eventSource.attr("name",eventSourceNameNew)};this.setEventParams=function($event,params){$event.children("parameter").remove();if(params==""){return}var paramsArray=params.split(",");for(var i=0;i<paramsArray.length;i++){var parameterDom=_domDocument.createElement("parameter");var param=paramsArray[i];var paramArray=param.match(/(\S+)\s(\S+)/);if(paramArray){var type=paramArray[1];var name=paramArray[2];$(parameterDom).attr("name",name);var indexOfReference=type.indexOf("&");var indexOfPointer=type.indexOf("*");if(indexOfReference>0){type=type.substring(0,indexOfReference);$(parameterDom).attr("type",type);$(parameterDom).attr("passedBy","reference")}else{if(indexOfPointer>0){type=type.substring(0,indexOfPointer);$(parameterDom).attr("type",type);$(parameterDom).attr("passedBy","pointer")}else{$(parameterDom).attr("type",type)}}$event.append($(parameterDom))}}};this.removeSpace=function(string){return string.replace("/ /g","")};this.eventRemove=function(eventId){var $event=this.getEvent(eventId);$event.remove()};this.eventCopy=function(eventId){var $event=this.getEvent(eventId);return $event.clone()};this.eventPaste=function(eventId,below,$eventToCopy){if(($eventToCopy==undefined)||($eventToCopy.size()==0)){return}var $event=this.getEvent(eventId);if($event.size()==0){var eventSourceName=this.getEventSourceFromEventId(eventId);var $eventSource=this.getEventSource(eventSourceName);$eventSource.append($eventToCopy)}else{if(below==true){$eventToCopy.insertAfter($event)}else{$eventToCopy.insertBefore($event)}}};this.eventSourceRemove=function(eventSourceName){var $eventSource=this.getEventSource(eventSourceName);$eventSource.remove()};this.eventSourceCopy=function(eventSourceName){var $eventSource=this.getEventSource(eventSourceName);return $eventSource.clone()};this.eventSourcePaste=function(eventSourceName,below,$eventSourceToCopy){if(($eventSourceToCopy==undefined)||($eventSourceToCopy.size()==0)){return}var $eventSource=this.getEventSource(eventSourceName);if($eventSource.size()==0){var $events=this.getEvents(eventSourceName);$events.append($eventSourceToCopy)}else{if(below==true){$eventSourceToCopy.insertAfter($eventSource)}else{$eventSourceToCopy.insertBefore($eventSource)}}};this.getEvents=function(){return $xml.find("events")};this.getEventSourceFromEventId=function(eventId){var $event=this.getEvent(eventId);var eventSourceName=$event.parent().attr("name");return eventSourceName};this.getEventSource=function(eventSourceName){if(eventSourceName&&eventSourceName!=""){return $xml.find("eventSource[name="+eventSourceName+"]")}else{return $xml.find("eventSource:first")}};this.hasEventSource=function(eventSourceName){if($xml.find("eventSource[name="+eventSourceName+"]").size()>0){return true}else{return false}};this.getEvent=function(eventId){return $xml.find("event[id="+eventId+"],timer[id="+eventId+"]")};this.getEventCount=function(eventSourceName){var eventSource=this.getEventSource(eventSourceName);var eventCount=$(eventSource).children().length;return eventCount};this.getEventType=function(eventId){return this.getEvent(eventId).get(0).nodeName};this.getEventId=function($event){return $event.attr("id")};this.getEventName=function(eventId){return this.getEvent(eventId).attr("name")};this.getEventParams=function(eventId){var params="";var $params=this.getEvent(eventId).children("parameter");$params.each(function(i){var passedByValue=$(this).attr("passedBy");var passedBy="";if(passedByValue=="reference"){passedBy="&"}else{if(passedByValue=="pointer"){passedBy="*"}}var param=$(this).attr("type")+passedBy+" "+$(this).attr("name");params=params+param;if(i+1<$params.size()){params=params+", "}});return params};this.getEventPreAction=function(eventId){return this.getEvent(eventId).attr("preAction")};this.setEventPreAction=function($eventId,preAction){if(preAction!=""){$eventId.attr("preAction",preAction)}else{$eventId.removeAttr("preAction")}};this.getEventPostAction=function(eventId){return this.getEvent(eventId).attr("postAction")};this.setEventPostAction=function($eventId,postAction){if(postAction!=""){$eventId.attr("postAction",postAction)}else{$eventId.removeAttr("postAction")}};this.parallelAdd=function(stateName,parallelCount,nextState){if(this.hasChild(stateName)==true){return}var $state=this._getState(stateName);var $parallel=$(_domDocument.createElement("parallel"));$parallel.appendTo($state);if(nextState){$parallel.attr("nextState",nextState);if(this.hasState(nextState)==false){this.createState(stateName,nextState)}}for(i=0;i<parallelCount;i++){var $stateOrthognal=$(_domDocument.createElement("state"));$stateOrthognal.attr("name","S"+i).appendTo($parallel);var $stateInit=$(_domDocument.createElement("state"));$stateInit.attr("name","SInit"+i).appendTo($stateOrthognal);var $stateEnd=$(_domDocument.createElement("state"));$stateEnd.attr("name","SEnd"+i).attr("kind","final").appendTo($stateOrthognal)}};this.parallelEdit=function(stateName,nextState){if(this.hasParallel(stateName)==false){return}var $parallel=this.getParallel(stateName);$parallel.attr("nextState",nextState)};this.parallelGetNextState=function(stateName){if(this.hasParallel(stateName)==false){return""}return this.getParallel(stateName).attr("nextState")};this.parallelRemove=function(stateName){this.getParallel(stateName).remove()};this.createState=function(stateName,newState){$nextState=$(_domDocument.createElement("state"));$nextState.attr("name",newState);this.getState(stateName).after($nextState)}}function State($state,$stateParent,$stateParallel,context){this.$state=$state;this.$stateParent=$stateParent;this.$stateParallel=$stateParallel;this.context=context;context.addState($state.attr("name"),$state)}function Context(contextParent){this.states=[];this.parent=contextParent;this.addState=function(stateName,$state){this.states[stateName]=$state}};function StateMachineView(){var _model;this.resetStateView=function(){$(".qtip").remove();$(".DrillDownTopContainerActionCloned").remove();$(".DrillDownTopContainerTransitionCloned").remove();$(".DrillDownTopContainerStateCloned").remove();$("#StateMachineDiagram").children().remove()};this.resetEventView=function(){$("#TableEventBody").children().remove()};function isModelValid(model){if((model==undefined)||(model.isValid()==false)){return false}else{return true}}this.buildStateView=function(model){if(isModelValid(model)==false){return}_model=model;if(model.getLanguage()!="dotnet"){$(".EventPrePostAction").css("display","none")}var stateMachineDiagram=document.getElementById("StateMachineDiagram");this.resetStateView();if(model.getXmlContent()==undefined){throw"No model selected"}var $stateRoot=model.getStateRoot();if($stateRoot.size()==1){this.stateParse(model,$stateRoot,null,null,stateMachineDiagram);this.writeTitle(model,stateMachineDiagram)}else{throw"Cannot the find root state"}};this.buildEventView=function(model){if(isModelValid(model)==false){return}if(model.getXmlContent()==undefined){throw"No model selected"}var view=this;model.getXml().find("eventSource").each(function(){view.buildEventSourceTable($(this))})};this.buildEventSourceTable=function($eventSource){var view=this;$eventSource.children().each(function(index){view.createEventRow($eventSource,this,index)})};this.createEventRow=function($eventSource,eventNode,index){var eventSourceName=$eventSource.attr("name");var type=eventNode.nodeName;var id=$(eventNode).attr("id");var $tr=$(document.createElement("tr"));$tr.attr("data-event-source",eventSourceName);$tr.attr("data-event-id",id);$("#TableEventBody").append($tr);if(index==0){var $tdEventSourceName=$(document.createElement("th"));$tdEventSourceName.attr("rowspan",_model.getEventCount(eventSourceName));$tdEventSourceName.addClass("eventSource");$tdEventSourceName.text(eventSourceName);$tr.append($tdEventSourceName)}$tr.append("<td class='event'>"+id+"</td><td class='event'>"+type+"</td>")};this.getEventSource=function(eventView){return $(eventView).parent().attr("data-event-source")};this.getEventId=function(eventView){return $(eventView).parent().attr("data-event-id")};this.getStateName=function(state){return $(state).attr("id")};this.getStateFromAction=function(action){return action.parentNode.parentNode.parentNode.parentNode.parentNode};this.getStateFromTransition=function(transition){return transition.parentNode.parentNode.parentNode};this.getStateFromParallel=function(parallel){return parallel.parentNode.parentNode.parentNode};this.getTransitionFromAction=function(action){return action.parentNode.parentNode};this.getTransitionPointingToState=function($state){var stateName=this.getStateName($state.parent());var $nextState=$(".nextState"+stateName);return $nextState.parent()};this.buildParallelNextState=function(model,$state,stateDiv,$parallel){if(($parallel==undefined)||($parallel.size()==0)){return}if(model.isStateRoot(model.getStateName($state))){return}var nextStateName=model.getParallelNextState($parallel);var parallelTableDiv=document.createElement("table");stateDiv.appendChild(parallelTableDiv);$(parallelTableDiv).addClass("parallelTable");var tbodyDiv=document.createElement("tbody");parallelTableDiv.appendChild(tbodyDiv);var tr=document.createElement("tr");tr.setAttribute("class","parallelTr");$(tr).addClass("parallelNextState");tbodyDiv.appendChild(tr);var tdArrow=document.createElement("td");tr.appendChild(tdArrow);$(tdArrow).addClass("shrink");tdArrow.innerHTML="<span class='ui-icon ui-icon-circle-arrow-e'>";var tdNextState=document.createElement("td");tr.appendChild(tdNextState);$(tdNextState).addClass("parallelNextStateName");$(tdNextState).addClass("expand");if(nextStateName){$(tdNextState).addClass("nextState"+nextStateName);tdNextState.innerHTML=nextStateName}else{}};this.buildStateParallel=function(model,$stateCurrent,stateDiv,$parallel,stateChildrenDiv){$(stateDiv).addClass("StateParallel");var $stateOrthogonalList=model.getChildList($parallel);for(i=0;i<$stateOrthogonalList.length;i++){var stateOrthogonalChild=$stateOrthogonalList[i];this.stateParse(model,$(stateOrthogonalChild),null,$stateCurrent,stateChildrenDiv)}};this.stateParse=function(model,$stateCurrent,$stateParent,$stateParallel,stateParentDiv){var i;var stateDiv=document.createElement("div");var stateName=model.getStateName($stateCurrent);stateDiv.setAttribute("id",stateName);var stateTitleDiv=document.createElement("div");stateDiv.appendChild(stateTitleDiv);$(stateTitleDiv).addClass("stateTitle");$("<span/>").addClass("stateTitleName").text(stateName).appendTo($(stateTitleDiv));var $parallel=model.getParallel(stateName);this.buildParallelNextState(model,$stateCurrent,stateDiv,$parallel);stateParentDiv.appendChild(stateDiv);var tableDiv=document.createElement("table");stateDiv.appendChild(tableDiv);var tbodyDiv=document.createElement("tbody");tableDiv.appendChild(tbodyDiv);this.writeEntryExit(model,$stateCurrent,tbodyDiv);this.writeTransitions(model,$stateCurrent,tbodyDiv);if($stateParent==null){if($stateParallel==null){$(stateDiv).addClass("StateRoot")}else{$(stateDiv).addClass("StateOrthogonal")}}else{$(stateDiv).addClass("State")}var $stateChildList=model.getChildList($stateCurrent);if(($parallel.size()==0)&&($stateChildList.size()==0)){var stateKind=model.getStateKind(stateName);if(stateKind=="final"){$(stateDiv).addClass("StateFinal")}else{if(stateKind=="history"){$(stateDiv).addClass("StateHistory")}else{$(stateDiv).addClass("StateLeaf")}}return}var stateTrChildrenDiv=document.createElement("tr");tbodyDiv.appendChild(stateTrChildrenDiv);var stateTdChildrenDiv=document.createElement("td");stateTdChildrenDiv.setAttribute("colspan","5");stateTrChildrenDiv.appendChild(stateTdChildrenDiv);var stateChildrenDiv=document.createElement("div");stateChildrenDiv.setAttribute("class","StateChildren");stateTdChildrenDiv.appendChild(stateChildrenDiv);if($parallel.size()==0){for(i=0;i<$stateChildList.length;i++){var stateChild=$stateChildList[i];this.stateParse(model,$(stateChild),$stateCurrent,$stateParallel,stateChildrenDiv)}}else{this.buildStateParallel(model,$stateCurrent,stateDiv,$parallel,stateChildrenDiv)}return};this.writeEntryExit=function(model,$state,stateDiv){if((model.getOnEntry($state).size()>0)||(model.getOnExit($state).size()>0)){this.writeOnEntryExit(model,$state,stateDiv,"onEntry","Entry");this.writeOnEntryExit(model,$state,stateDiv,"onExit","Exit")}};this.writeOnEntryExit=function(model,$state,tbody,entryExitTagName,entryExitLabel){var $entryExit=model.getFirstElement($state,entryExitTagName);if($entryExit.size()>0){var tr=document.createElement("tr");tr.setAttribute("class",entryExitLabel);tbody.appendChild(tr);var tdEntryExitIcon=document.createElement("td");$(tdEntryExitIcon).addClass("shrink");tr.appendChild(tdEntryExitIcon);if(entryExitLabel=="Entry"){tdEntryExitIcon.innerHTML="<span class='ui-icon ui-icon-circle-plus'>"}else{tdEntryExitIcon.innerHTML="<span class='ui-icon ui-icon-circle-minus'>"}var actions=document.createElement("td");$(actions).addClass("actions");tr.appendChild(actions);actions.setAttribute("colspan","4");if(model.hasAction($entryExit)==true){this.writeActions(model,$state,$entryExit,actions)}}};this.writeTransitions=function(model,$state,stateDiv){var $transitionList=model.getTransitionList($state);if($transitionList.size()==0){return}for(var i=0;i<$transitionList.length;i++){var transition=$transitionList[i];this.writeTransition(model,$state,$(transition),stateDiv,i)}};this.writeTransition=function(model,$state,$transition,tbody,index){var tr=document.createElement("tr");tr.setAttribute("class","transition");tr.setAttribute("data-transition-index",index);tbody.appendChild(tr);this.writeTransitionArrowEvent(model,tr);this.writeTransitionEvent(model,$transition,tr);if(model.hasStateAction($state)){var td=document.createElement("td");$(td).addClass("shrink");tr.appendChild(td);this.writeActions(model,$state,$transition,td)}this.writeTransitionArrowState(model,tr);var nextState=model.getTransitionNextState($transition);this.writeTransitionNextState(model,nextState,tr)};this.writeTransitionArrowEvent=function(model,tr){var td=document.createElement("td");tr.appendChild(td);$(td).addClass("shrink");$(td).addClass("transitionEventArrow");td.innerHTML="<span class='ui-icon ui-icon-arrowreturnthick-1-n'>"};this.writeTransitionEvent=function(model,$transition,tr){var td=document.createElement("td");tr.appendChild(td);$(td).addClass("shrink");$(td).addClass("transitionEvent");td.innerHTML=model.getTransitionName($transition)};this.writeTransitionArrowState=function(model,tr){var td=document.createElement("td");tr.appendChild(td);$(td).addClass("shrink");$(td).addClass("transitionEventState");td.innerHTML="<span class='ui-icon ui-icon-circle-arrow-e'>"};this.writeActions=function(model,$state,$node,td){var containerName=$node.get(0).nodeName;var actionInAttr=model.getActionInAttribute($node);if(actionInAttr){this.writeAction(model,containerName,actionInAttr,true,td)}var me=this;$node.find("action,timerStart,timerStop").each(function(index){if(this.nodeName=="action"){me.writeAction(model,containerName,$(this).text(),false,td,index)}else{if(this.nodeName=="timerStart"){me.writeTransitionTimerStart(model,containerName,$(this),td,index)}else{if(this.nodeName=="timerStop"){me.writeTransitionTimerStop(model,containerName,$(this),td,index)}}}})};this.writeAction=function(model,containerName,actionContent,attribute,td,index){if(actionContent){var actionContentDiv=document.createElement("div");td.appendChild(actionContentDiv);actionContentDiv.setAttribute("class","action");actionContentDiv.setAttribute("data-action-container",containerName);actionContentDiv.setAttribute("data-action-type","code");if(attribute==true){actionContentDiv.setAttribute("data-action-attribute","true")}else{actionContentDiv.setAttribute("data-action-index",index)}var actionContentSpan=document.createElement("span");actionContentDiv.appendChild(actionContentSpan);actionContentSpan.setAttribute("class","actionContent");actionContentSpan.appendChild(document.createTextNode(actionContent))}};this.writeTransitionTimerStart=function(model,containerName,$timerStart,td,index){this.writeTransitionTimerCommon(model,containerName,$timerStart,td,"timerStart: ",model.getTimerName($timerStart),index)};this.writeTransitionTimerStop=function(model,containerName,$timerStop,td,index){this.writeTransitionTimerCommon(model,containerName,$timerStop,td,"timerStop: ",model.getTimerName($timerStop),index)};this.writeTransitionTimerCommon=function(model,containerName,$timerStartStop,td,timerLabel,timerName,index){var transitionActionContentDiv=document.createElement("div");td.appendChild(transitionActionContentDiv);transitionActionContentDiv.setAttribute("class","action");transitionActionContentDiv.setAttribute("data-action-container",containerName);transitionActionContentDiv.setAttribute("data-action-type",$timerStartStop.get(0).nodeName);transitionActionContentDiv.setAttribute("data-action-index",index);var timerSpan=document.createElement("span");transitionActionContentDiv.appendChild(timerSpan);timerSpan.setAttribute("class","tagName");timerSpan.appendChild(document.createTextNode(timerLabel));var actionContentSpan=document.createElement("span");transitionActionContentDiv.appendChild(actionContentSpan);actionContentSpan.setAttribute("class","actionContent");actionContentSpan.appendChild(document.createTextNode(timerName))};this.writeTransitionNextState=function(model,nextState,tr){var td=document.createElement("td");tr.appendChild(td);$(td).addClass("transitionNextState");$(td).addClass("expand");if(nextState){$(td).addClass("nextState"+nextState);td.innerHTML=nextState}else{td.innerHTML='<span class="tagName">self</span>'}};this.writeTitle=function(model,stateDiagramDiv){var modelName=model.getName();if(modelName){var titleDiv=document.createElement("h2");titleDiv.setAttribute("id","StateMachineTitle");titleDiv.appendChild(document.createTextNode(modelName));stateDiagramDiv.appendChild(titleDiv)}}};var examplesDotNetArray=new Array("Light","Led","Turnstile","TrafficLight","Ping","BookingProcess","Microwave","WashingMachine","Seminar","Door","DoorTest01","DoorTest02","TestChat01","TestLogin02","TestRegisterNewAccount","TestOpenClose01","TestOpenClose02","TestRosterAdd","TestRosterAddRemove","TestSubscription01","TestUnSubscribe");var examplesCppArray=new Array("HelloWorld","Led","Light","Ping","Door","DoorTester","TrafficLight","WashingMachine","Microwave","Microwave02","LoginMvc","Robot","UrlGet","Samek","Tr69Connection","Tr69ConnectionRequestResponder","Tr69ConnectionRequestServer","AcsClient","AcsConnection","AcsRequestDownload","AcsRequestReboot");var examplesJavaArray=new Array("RippleWsClient","FeedFetcher","HelloWorld","Led","Microwave","Ping","TrafficLight","PelicanCrossing");var screenshootArray=new Array("Door","HelloWorld","Light","Ping","TrafficLight","WashingMachine","XmppRosterAdd","UrlGet");function examplesCreateAll(){examplesCreate("examplesDotNetUL",examplesDotNetArray,"/examples/dotnet","fsmcs");examplesCreate("examplesCppUL",examplesCppArray,"/examples/cpp","fsmcpp");examplesCreate("examplesJavaUL",examplesJavaArray,"/examples/java","fsmjava")}function getStateMachineUrlFromName(name,urlPrefix,fileSuffix){return urlPrefix+"/"+name+"."+fileSuffix}function examplesCreate(div,array,urlPrefix,fileSuffix){var examplesDiv=document.getElementById(div);for(i=0;i<array.length;i++){var example=array[i];var li=document.createElement("li");examplesDiv.appendChild(li);var anchor=document.createElement("a");li.appendChild(anchor);anchor.setAttribute("href","/StateMachineDiagram/StateMachineDiagram.html?fsmUrl="+getStateMachineUrlFromName(example,urlPrefix,fileSuffix)+"#");anchor.setAttribute("class","SateMachineExample");anchor.appendChild(document.createTextNode(example))}}$(document).ready(function(){if(jQuery("#examplesCarousel").size()==0){return}jQuery("#examplesCarousel").jcarousel({scroll:1,itemLoadCallback:mycarousel_itemLoadCallback,auto:4,wrap:"last",initCallback:mycarousel_initCallback})});function mycarousel_initCallback(carousel){carousel.buttonNext.bind("click",function(){carousel.startAuto(0)});carousel.buttonPrev.bind("click",function(){carousel.startAuto(0)});carousel.clip.hover(function(){carousel.stopAuto()},function(){carousel.startAuto()})}function mycarousel_itemLoadCallback(carousel,state){if(state!="init"){return}var array=screenshootArray;for(i=0;i<array.length;i++){var example=array[i];carousel.add(i+1,mycarousel_getItemHTML(array[i]))}carousel.size(array.length)}function mycarousel_getItemHTML(name){var url="/StateMachineDiagram/Img/"+name+"StateMachine.png";return'<img src="'+url+'" alt="'+name+'" />'};var stateEditorMainWindow;var stateMachineController;function StateMachineController(){var model;var view;var viewCurrentState;var viewCurrentParallel;var stateNameCurrent;var viewCurrentAction;var viewCurrentTransition;var viewCurrentEvent;var $copiedState;var $copiedTransition;var $copiedAction;var $copiedEvent;var $copiedEventSource;var tabView;var editor;var tabCurrentName;var _actionContainer;var _actionType;var _command;var _eventIdCurrent;var _eventSourceCurrent;var _eventNameCurrent;var textEnterStateName="Enter state name";var apiFile=false;var stackStateMachine=[];var stackStateMachineRedo=[];var _from;var editorApiWriting;this.init=function(from){_from=from;checkFileApi();view=new StateMachineView();tabViewInit();initToolBar();initButtonTheme();initDiagram()};function initTabEvents(){$("thead").each(function(){$(this).addClass("ui-widget-header")});$(".stateTitle").each(function(){$(this).addClass("ui-widget-header ui-widget-content")});$(".dd-header").each(function(){$(this).addClass("ui-widget-header")});$(".entryExitTable").each(function(){$(this).addClass("ui-widget-content")});$(".State,.StateRoot,.StateOrthogonal").each(function(){$(this).addClass("ui-widget ui-widget-content")});$("#StateMachineDiagram table th,  #TableEventContainer table th").each(function(){$(this).addClass("ui-state-default")});$("#StateMachineDiagram tr").each(function(){$(this).addClass("ui-widget-content")});$(".StateRoot").removeClass("ui-corner-all");$(".StateHistory,.StateFinal").addClass("ui-corner-all");$("#TabView").children("ul").removeClass("ui-corner-all");$(".ui-tabs-nav").children("li").removeClass("ui-corner-top");$(".stateTitle").hover(function(){$(this).addClass("ui-state-highlight")},function(){$(this).removeClass("ui-state-highlight")});$(".stateTitle").hover(function(){var $transition=view.getTransitionPointingToState($(this));$transition.addClass("ui-state-highlight")},function(){var $transition=view.getTransitionPointingToState($(this));$transition.removeClass("ui-state-highlight")});$(".transition,.parallelTr").hover(function(){var nextstateName=$(this).children(".transitionNextState,.parallelNextStateName").text();var $nextState=$("#"+nextstateName);$nextState.addClass("ui-state-highlight");$nextState.children(".stateTitle").addClass("ui-state-highlight")},function(){var nextstateName=$(this).children(".transitionNextState,.parallelNextStateName").text();var $nextState=$("#"+nextstateName);$nextState.removeClass("ui-state-highlight");$nextState.children(".stateTitle").removeClass("ui-state-highlight")});$(".transition,.Entry,.parallelTr").hover(function(){$(this).children("td").addClass("ui-state-highlight")},function(){$(this).children("td").removeClass("ui-state-highlight")});$(".event").hover(function(){$(this).parent().children("td").addClass("ui-state-highlight")},function(){$(this).parent().children("td").removeClass("ui-state-highlight")})}function initButtonTheme(){$("#switcher").children().remove();$("#switcher").button();$("#switcher").themeswitcher({imgpath:"images/",loadTheme:"cupertino"});$("#switcher").children("span:first").remove();$("#switcher").children("a").addClass("ui-button-text");$("#switcher").children("div").addClass("ui-widget ui-widget-content");$(".jquery-ui-switcher-link").attr("style","");$(".jquery-ui-switcher-title").attr("style","");$(".jquery-ui-switcher-arrow").attr("style","")}function initToolBar(){$(".Undo").button().click(diagramUndo);$(".Redo").button().click(diagramRedo)}function diagramUndo(){var xmlCurrent=stackStateMachine.pop();if(xmlCurrent){stackStateMachineRedo.push(xmlCurrent)}var xmlPrevious=stackStateMachine[stackStateMachine.length-1];if(xmlPrevious){model=new StateMachineModel();model.xmlToDom(xmlPrevious);viewStateBuild();viewEventBuild()}}function diagramRedo(){var xmlPrevious=stackStateMachineRedo.pop();if(xmlPrevious){stackStateMachine.push(xmlPrevious);model=new StateMachineModel();model.xmlToDom(xmlPrevious);viewStateBuild();viewEventBuild()}}function initDiagram(){if(stateEditorMainWindow){$("#TopMenu").css("display","none");$("#StateEditorDesktopAlert").css("display","none")}if(_from=="fromLocalFile"){}else{showFsmFileFromUrl()}}function showFsmFileFromUrl(hash){var fsmUrl=getParameterByName("fsmUrl");if(fsmUrl){retrieveFsmContentFromUrl(fsmUrl);return true}return false}function retrieveFsmContentFromUrl(url){$.get(url,{},function(data){onContentReceived(data)},"text")}function onContentReceived(data){tabView.tabs("option","selected",1);modelBuild(data);viewStateBuild()}function getFsmFileFromLocalStorage(){var stateMachineXmlInCache=localStorageGet("StateMachineXml");modelBuild(stateMachineXmlInCache)}function localStorageSet(key,value){if(Modernizr.localstorage){localStorage.setItem(key,value)}}function localStorageGet(key){if(Modernizr.localstorage){localStorage.getItem(key)}}function tabViewInit(){tabView=$("#TabView").tabs({show:function(event,ui){switch(ui.index){case 0:handleClickTabWelcome(event);break;case 1:handleClickTabState(event);break;case 2:handleClickTabEvent(event);break;case 3:handleClickTabXmlCode(event);break}}});$("#TabView").removeClass("ui-corner-all");tabView.tabs("option","selected",0);function handleClickTabWelcome(e){tabCurrentName="Welcome";$("body").css("overflow","visible");tabCurrentName="State"}function handleClickTabState(e){if(tabCurrentName=="XmlCode"){xmlCodeOnExit()}$("body").css("overflow","visible");tabCurrentName="State";viewStateBuild()}function handleClickTabEvent(e){if(tabCurrentName=="XmlCode"){xmlCodeOnExit()}$("body").css("overflow","visible");tabCurrentName="Event";viewEventBuild()}function handleClickTabXmlCode(){$("body").css("overflow","hidden");tabCurrentName="XmlCode";editorUpdate()}function tabExit(newTab){if(tabCurrentName=="XmlCode"){xmlCodeOnExit()}}function xmlCodeOnExit(){editor.getSession().on("change",function(){});modelBuild(editorGetContent())}}function modelBuild(xmlContent){try{if(xmlContent!=undefined){stackStateMachine.push(xmlContent);model=new StateMachineModel();model.xmlToDom(xmlContent)}}catch(error){$("#StateDiagramError").show();$("#StateDiagramErrorMessage").text(error.toString())}}function viewStateBuild(){view.resetStateView();if(model&&model.isValid()){try{$("#StateDiagramError").hide();view.buildStateView(model);diagramBindEvent()}catch(error){$("#StateDiagramError").show();$("#StateDiagramErrorMessage").text(error.toString())}}}function viewEventBuild(){view.resetEventView();try{view.buildEventView(model);diagramBindEvent()}catch(error){}}function saveToLocalStorage(){if(model.getName()){localStorageSet("StateMachineXml",fsmXml)}}function diagramBindEvent(){cursor_wait();setTimeout(doDiagramBindEvent,50)}function doDiagramBindEvent(){initState();initTransition();initAction();initEvent();initEventSource();initParallelNextState();initStateDialog();initDialogAction();initDialogTransition();initDialogEvent();initDialogEventSource();initTabEvents();fillSelect("#SelectEvent",model.getEventIdList());fillSelect(".TimerList",model.getTimerNameList());$("#SelectEvent").combobox();$("#SelectStateNext").combobox();$("#SelectParallelAddNextState").combobox();$("#SelectParallelEditNextState").combobox();cursor_clear()}function initParallelNextState(){$(".parallelNextState").bind("click",onClickParallelEdit)}function initDialogAction(){createDialog("dialogActionEditCode","Save",onClickActionSave);createDialog("dialogActionEditTimerStart","Save",onClickActionSave);createDialog("dialogActionEditTimerStop","Save",onClickActionSave)}function fillSelect(id,list){$(id).empty();for(i=0;i<list.length;i++){var name=list[i];$(id).append('<option value="'+name+'">'+name+"</option>")}}function unsetCurrentView(){viewCurrentTransition=null;viewCurrentState=null;viewCurrentAction=null;viewCurrentEvent=null;viewCurrentParallel=null}function setCurrentViewState(stateView){unsetCurrentView();viewCurrentState=stateView}function getCurrentViewState(){return viewCurrentState}function setCurrentViewParallel(parallelView){unsetCurrentView();viewCurrentParallel=parallelView}function getCurrentViewParallel(){return viewCurrentParallel}function setCurrentViewEvent(eventView){unsetCurrentView();viewCurrentEvent=eventView}function getCurrentViewEvent(){return viewCurrentEvent}function getCurrentStateName(){var stateName="??";var actionView=getCurrentViewAction();var transitionView=getCurrentViewTransition();var stateView=getCurrentViewState();var parallelView=getCurrentViewParallel();if(actionView){stateView=view.getStateFromAction(actionView);stateName=view.getStateName(stateView)}else{if(transitionView){stateView=view.getStateFromTransition(transitionView);stateName=view.getStateName(stateView)}else{if(stateView){stateName=view.getStateName(stateView)}else{if(parallelView){stateView=view.getStateFromParallel(parallelView);stateName=view.getStateName(stateView)}}}}return stateName}function setCurrentViewAction(view){unsetCurrentView();viewCurrentAction=view}function getCurrentViewAction(){return viewCurrentAction}function setCurrentViewTransition(view){unsetCurrentView();viewCurrentTransition=view}function getCurrentViewTransition(){if(viewCurrentTransition){return viewCurrentTransition.parentNode}return null}function hideToolTip(){$(".qtip.ui-tooltip").qtip("hide")}function saveAndShowStateView(){hideToolTip();domToXml();viewStateBuild();saveToLocalStorage();modelModified()}this.setXmlContent=function(xmlContent){onContentReceived(xmlContent)};this.getXmlContent=function(){return model.domToXml()};function domToXml(){var xmlContent=model.domToXml();if(xmlContent){stackStateMachine.push(xmlContent)}return xmlContent}function saveAndShowEventView(){hideToolTip();domToXml();viewEventBuild();saveToLocalStorage()}function getStateNext(transition){var nextState="";transition.children(".nextState").children("p").each(function(){nextState=$(this).text()});return nextState}function getParameterByName(name){var match=RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))}function editorShow(){}function editorUpdate(){codeEditorInit();editor.getSession().on("change",function(){if((editorApiWriting==false)&&(editorGetContent()!="")){modelModified()}});var xmlContent=domToXml();editorSetContent(xmlContent);editorResize()}function editorSetContent(content){if(editor&&content){editorApiWriting=true;editor.getSession().setValue(content);editorApiWriting=false;editor.gotoLine(0)}}function editorGetContent(){if(editor){return editor.getSession().getValue()}else{return""}}function editorResize(){$("#StateMachineEditor").css("width",document.body.clientWidth);var height=getDocHeight()-$(".yui-nav").height()-$("#EditorMenuContainer").height();$("#StateMachineEditor").css("height",height);editor.resize()}function codeEditorInit(){if(editor){return}editor=ace.edit("editor");editor.setTheme("ace/theme/clouds");var EditSession=require("ace/edit_session").EditSession;var XmlScriptMode=require("ace/mode/xml").Mode;editor.getSession().setMode(new XmlScriptMode())}function getDocHeight(){var D=document;return Math.max(D.body.clientHeight,D.documentElement.clientHeight)}function createTransitionDrilldown(){var content=createDrilldown("Transition");return content}function initTransitionMenuCallback(){$(".TransitionAdd").bind("click",onClickTransitionAdd);$(".TransitionEdit").bind("click",onClickTransitionEdit);$(".TransitionCodeAdd").bind("click",{actionContainer:"transition",actionType:"Code"},onClickActionAdd);$(".TransitionTimerStart").bind("click",{actionContainer:"transition",actionType:"TimerStart"},onClickActionAdd);$(".TransitionTimerStop").bind("click",{actionContainer:"transition",actionType:"TimerStop"},onClickActionAdd);$(".TransitionCut").bind("click",onClickTransitionCut);$(".TransitionPasteAbove").bind("click",{below:false},onClickTransitionPaste);$(".TransitionPasteBelow").bind("click",{below:true},onClickTransitionPaste)}function initTransition(){$(".transitionEventArrow,.transitionEvent,.transitionEventState,.transitionNextState").bind("click",function(event){var content=createTransitionDrilldown();setCurrentViewTransition(this);createMenu($(this),event,content,"Transition");initTransitionMenuCallback()})}function initDialogTransition(){createDialog("dialogTransitionEdit","Save transition",onClickTransitionSave)}function onClickTransitionEdit(event){event.stopPropagation();hideToolTip();var stateName=getCurrentStateName();var transitionView=getCurrentViewTransition();var transitionIndex=$(transitionView).attr("data-transition-index");var transition=model.getTransition(stateName,transitionIndex);unsetError("#InputSelectEvent");unsetError("#InputSelectStateNext");$("#InputSelectEvent").val(model.getTransitionEvent(transition));$("#TransitionCondition").val(model.getCondition(transition));fillSelect("#SelectStateNext",model.getNextStateNameList(stateName));$("#SelectStateNext").append($("<option/>").attr("value","internal transition").text("internal transition"));var nextState=model.getTransitionNextState(transition);if(nextState==undefined){nextState="internal transition"}$("#InputSelectStateNext").val(nextState);_command="edit";$("#dialogTransitionEdit").dialog("option","title","Edit transition for state "+stateName);$("#dialogTransitionEdit").dialog("open");return false}function onClickTransitionAdd(event){event.stopPropagation();hideToolTip();var stateName=getCurrentStateName();var transitionView=getCurrentViewTransition();var stateView;if(transitionView){stateView=view.getStateFromTransition(transitionView)}else{stateView=getCurrentViewState()}unsetError("#InputSelectEvent");unsetError("#InputSelectStateNext");$("#TransitionCondition").val("");fillSelect("#SelectStateNext",model.getNextStateNameList(stateName));$("#SelectStateNext").append($("<option/>").attr("value","_InternalTransition_").text("internal transition"));$("#InputSelectStateNext").val(stateName);_command="add";$("#dialogTransitionEdit").dialog("option","title","Add transition for state "+stateName);$("#dialogTransitionEdit").dialog("open");return false}function onClickTransitionSave(){var command=_command;var transitionView=getCurrentViewTransition();var stateView;var transitionIndex;var stateName=getCurrentStateName();if(transitionView){stateView=view.getStateFromTransition(transitionView);transitionIndex=$(transitionView).attr("data-transition-index")}else{stateView=getCurrentViewState();transitionIndex=model.getTransitionCount(stateName)}var eventId=$("#InputSelectEvent").val();var condition=$("#TransitionCondition").val();var nextState=$("#InputSelectStateNext").val();var error=false;if(nextState=="internal transition"){nextState=""}else{var errorMessage=isValidState(nextState);if(errorMessage){error=true;setError("#InputSelectStateNext",errorMessage)}else{unsetError("#InputSelectStateNext");if(model.hasState(nextState)==false){model.createState(stateName,nextState)}}}var errorEventId=isEventIdValid(eventId);if(errorEventId){error=true;setError("#InputSelectEvent",errorEventId)}else{unsetError("#InputSelectEvent")}if(error==false){if(command=="add"){model.transitionAdd(stateName,transitionIndex,eventId,condition,nextState)}else{model.transitionEdit(stateName,transitionIndex,eventId,condition,nextState)}$("#dialogTransitionEdit").dialog("close");saveAndShowStateView()}}function setError(id,message){$(id).addClass("ui-state-error");setToolTipError(id,message)}function unsetError(id){$(id).removeClass("ui-state-error")}function onClickTransitionCut(evt){var stateName=getCurrentStateName();var transitionView=getCurrentViewTransition();var stateView=view.getStateFromTransition(transitionView);var transitionIndex=$(transitionView).attr("data-transition-index");$copiedTransition=model.transitionCopy(stateName,transitionIndex);model.transitionRemove(stateName,transitionIndex);saveAndShowStateView()}function onClickTransitionPaste(evt){var below=evt.data.below;var stateName=getCurrentStateName();var transitionView=getCurrentViewTransition();var transitionIndex=$(transitionView).attr("data-transition-index");model.transitionPaste(stateName,transitionIndex,below,$copiedTransition);saveAndShowStateView()}function createStateDrillDown(stateName){var drillDownId="drillDownStateCloned";$("#"+drillDownId).remove();var content=$(".DrillDownTopContainerState").first().clone();content.find(".drillDownState").attr("id",drillDownId);var lastContainer=$(".DrillDownTopContainerState").last();content.insertAfter(lastContainer);if(model.isStateRoot(stateName)==true){$("#"+drillDownId).find(".LiStateCut,.LiStateDelete,.LiStatePasteAfter,.LiStatePasteBefore").remove()}if(model.hasParallel(stateName)==false){$("#"+drillDownId).find(".LiParallelEdit,.LiParallelRemove").remove()}if(model.hasChild(stateName)==true){$("#"+drillDownId).find(".LiParallelAdd").remove()}if($("#"+drillDownId).find(".LiParallel").find("li").size()==0){$("#"+drillDownId).find(".LiParallel").remove()}$("#"+drillDownId).dcDrilldown({speed:"fast",saveState:false,showCount:false,defaultText:"State Operations"});return content}function initStateCallback(){$(".StateAdd").bind("click",onClickStateAdd);$(".StateEdit").bind("click",onClickStateEdit);$(".StateEntryCodeAdd").bind("click",{actionContainer:"onEntry",actionType:"Code"},onClickActionAdd);$(".StateExitCodeAdd").bind("click",{actionContainer:"onExit",actionType:"Code"},onClickActionAdd);$(".StateEntryTimerStart").bind("click",{actionContainer:"onEntry",actionType:"TimerStart"},onClickActionAdd);$(".StateExitTimerStart").bind("click",{actionContainer:"onExit",actionType:"TimerStart"},onClickActionAdd);$(".StateEntryTimerStop").bind("click",{actionContainer:"onEntry",actionType:"TimerStop"},onClickActionAdd);$(".StateExitTimerStop").bind("click",{actionContainer:"onExit",actionType:"TimerStop"},onClickActionAdd);$(".StateEntryRemove").bind("click",{actionContainer:"onEntry"},onClickActionContainerRemove);$(".StateExitRemove").bind("click",{actionContainer:"onExit"},onClickActionContainerRemove);$(".StateEntryPasteAction").bind("click",{actionContainer:"onEntry"},onClickStateActionPaste);$(".StateExitPasteAction").bind("click",{actionContainer:"onExit"},onClickStateActionPaste);$(".StateTransitionAdd").bind("click",{actionContainer:"transition"},onClickTransitionAdd);$(".StateTransitionsRemove").bind("click",{actionContainer:"transition"},onClickActionContainerRemove);$(".StateTransitionPaste").bind("click",{actionContainer:"transition"},onClickStateTransitionPaste);$(".StateDelete").bind("click",onClickStateDelete);$(".StateCut").bind("click",onClickStateCut);$(".StatePasteAfter").bind("click",{pasteAs:"after"},onClickStatePaste);$(".StatePasteBefore").bind("click",{pasteAs:"before"},onClickStatePaste);$(".StatePasteAsChild").bind("click",{pasteAs:"asChild"},onClickStatePaste);$(".ParallelAdd").bind("click",onClickParallelAdd);$(".ParallelEdit").bind("click",onClickParallelEdit);$(".ParallelRemove").bind("click",onClickParallelRemove)}function initState(){$(".stateTitle").bind("click",function(event){$(".DrillDownTopContainerState").css("display","block");var stateName=$(this).text();var content=createStateDrillDown(stateName);setCurrentViewState($(this).parent());createMenu($(this),event,content,"State");initStateCallback()})}function createDialog(dialogName,buttonTexta,callbackOk){$("#"+dialogName).dialog("destroy");$("#"+dialogName).dialog({modal:true,autoOpen:false,width:"auto",buttons:{Save:{text:buttonTexta,click:callbackOk},Cancel:function(){$(this).dialog("close")}},close:function(){hideToolTip()}}).unbind("keyup").bind("keyup",function(evt){if(evt.keyCode=="13"){evt.stopPropagation();callbackOk(evt)}})}function initStateDialog(){createDialog("dialogStateAdd","Add state",onClickStateAddSave);createDialog("dialogStateEdit","Save state",onClickStateEditSave);createDialog("dialogStateRemove","Remove state",onClickStateRemoveSave);createDialog("dialogParallelAdd","Add parallel region",onClickParallelAddSave);createDialog("dialogParallelEdit","Save parallel region",onClickParallelEditSave)}function onClickStateRemoveSave(evt){var stateNameToRemove=getCurrentStateName();model.stateRemove(stateNameToRemove);$("#dialogStateRemove").dialog("close");saveAndShowStateView()}function onClickStateEdit(evt){hideToolTip();var stateName=getCurrentStateName();unsetError("#InputStateEdit");$("#InputStateEdit").val(stateName);if(model.isStateComposite(stateName)==true){$("#SelectStateEditKind").attr("disabled","disabled");$("#SelectStateEditKind").val("")}else{$("#SelectStateEditKind").removeAttr("disabled");var kind=model.getStateKind(stateName);if(kind){$("#SelectStateEditKind").val(kind)}else{$("#SelectStateEditKind").val("")}}$("#dialogStateEdit").dialog("open");return false}function dialogActionOpen(actionContainer,actionType,command){hideToolTip();_actionContainer=actionContainer;_actionType=actionType;_command=command;$("#dialogActionEdit"+actionType).dialog("open");return false}function onClickStateEditSave(evt){hideToolTip();var stateName=getCurrentStateName();var stateNameNew=$("#InputStateEdit").val();var error;if(stateName!=stateNameNew){if(model.hasState(stateNameNew)==true){error="State already exists"}else{error=isValidState(stateNameNew)}}if(error){setError("#InputStateEdit",error)}else{$("#dialogStateEdit").dialog("close");$("#InputStateEdit").qtip("destroy");model.stateRename(stateName,stateNameNew);model.setStateKind(stateNameNew,$("#SelectStateEditKind").val());saveAndShowStateView()}}function onClickStateAdd(evt){var stateName=getCurrentStateName();hideToolTip();unsetError("#InputStateAddNew");$("#InputStateAddNew").val("");$("#SelectStateAddNewKind").val("");if(model.isStateRoot(stateName)==true){$("#SelectStateAddWhere").val("below");$(".LiStateRemove").css("display","none")}else{$("#SelectStateAddWhere").val("after");$(".LiStateRemove").css("display","list-item")}$("#dialogStateAdd").dialog("open");return false}function onClickStateAddSave(evt){hideToolTip();var stateNameCurrent=getCurrentStateName();var whereToAdd="after";if(model.isStateRoot(stateNameCurrent)){whereToAdd="below"}else{whereToAdd=$("#SelectStateAddWhere").val()}var stateName=$("#InputStateAddNew").val();var error;if(model.hasState(stateName)==true){error="State already exists"}else{error=isValidState(stateName)}if(error){setError("#InputStateAddNew",error)}else{$("#dialogStateAdd").dialog("close");model.stateAdd(stateNameCurrent,stateName,$("#SelectStateAddNewKind").val(),whereToAdd);saveAndShowStateView()}}function setToolTipError(id,error){$(id).qtip({content:{text:error},style:{classes:"ui-tooltip-red ui-tooltip-shadow",widget:true},show:{event:false,ready:true},position:{my:"top center",at:"bottom center"},hide:{event:"unfocus"}})}function onClickActionContainerRemove(evt){var actionContainer=evt.data.actionContainer;var stateName=getCurrentStateName();model.removeActionContainer(stateName,actionContainer);saveAndShowStateView()}function onClickStateDelete(evt){var stateName=getCurrentStateName();model.stateRemove(stateName);var $transitions=model.getTransitionPointingToState(stateName);$transitions.remove();saveAndShowStateView()}function onClickStateCut(evt){var stateName=getCurrentStateName();$copiedState=model.stateCopy(stateName);model.stateRemove(stateName);saveAndShowStateView()}function onClickStatePaste(evt){var pasteAs=evt.data.pasteAs;var stateName=getCurrentStateName();model.statePaste(stateName,pasteAs,$copiedState);saveAndShowStateView()}function onClickStateActionPaste(evt){var actionContainer=evt.data.actionContainer;var stateName=getCurrentStateName();model.stateActionPaste(stateName,actionContainer,$copiedAction);$copiedAction=undefined;saveAndShowStateView()}function onClickStateTransitionPaste(evt){var stateName=getCurrentStateName();model.transitionPaste(stateName,0,"below",$copiedTransition);$copiedTransition=undefined;saveAndShowStateView()}function createActionDrilldown(stateName){var content=createDrilldown("Action");return content}function initActionMenuCallback(){$(".CodeAdd").bind("click",{actionContainer:"",actionType:"Code"},onClickActionAdd);$(".TimerStart").bind("click",{actionContainer:"",actionType:"TimerStart"},onClickActionAdd);$(".TimerStop").bind("click",{actionContainer:"",actionType:"TimerStop"},onClickActionAdd);$(".ActionEdit").bind("click",onClickEditAction);$(".ActionCut").bind("click",onClickActionCut);$(".ActionPasteAbove").bind("click",{below:false},onClickActionPaste);$(".ActionPasteBelow").bind("click",{below:true},onClickActionPaste)}function initAction(){$(".action").bind("click",function(event){var content=createActionDrilldown();setCurrentViewAction(this);createMenu($(this),event,content,"Action");initActionMenuCallback()})}function onClickActionAdd(evt){var actionContainer=evt.data.actionContainer;var actionType=evt.data.actionType;var stateName=getCurrentStateName();if(actionType=="Code"){$("#InputActionEdit").val("");$("#dialogActionEditCode").dialog("option","title","Add code in "+actionContainer+" for state "+stateName)}else{if(actionType=="TimerStart"){$("#TimerDuration").val("");$("#dialogActionEditTimerStart").dialog("option","title","Add timerStart in "+actionContainer+" for state "+stateName)}else{if(actionType=="TimerStop"){$("#dialogActionEditTimerStop").dialog("option","title","Add timerStop in "+actionContainer+" for state "+stateName)}}}return dialogActionOpen(actionContainer,actionType,"add")}function onClickEditAction(evt){var stateName=getCurrentStateName();var actionView=getCurrentViewAction();var stateView=view.getStateFromAction(actionView);var actionIndex=$(actionView).attr("data-action-index");var actionContainer=$(getCurrentViewAction()).attr("data-action-container");var actionContainerIndex=getActionContainerIndex(view,actionContainer,actionView);var actionType=$(getCurrentViewAction()).attr("data-action-type");if(actionType=="code"){var attribute=$(getCurrentViewAction()).attr("data-action-attribute");var code=model.codeGet(stateName,actionContainer,actionContainerIndex,actionIndex,attribute);$("#InputActionEdit").val(code);$("#dialogActionEditCode").dialog("option","title","Edit "+actionContainer+" code for state "+stateName);dialogActionOpen(actionContainer,"Code","edit")}else{if(actionType=="timerStart"){var timerStartName=model.timerStartGetName(stateName,actionContainer,actionContainerIndex,actionIndex);$("#TimerStartName").val(timerStartName);var timerDuration=model.timerGetDuration(stateName,actionContainer,actionContainerIndex,actionIndex);$("#TimerDuration").val(timerDuration);$("#dialogActionEditTimerStart").dialog("option","title","Edit timerStart in "+actionContainer+" for state "+stateName);dialogActionOpen(actionContainer,"TimerStart","edit")}else{if(actionType=="timerStop"){var timerStopName=model.timerStopGetName(stateName,actionContainer,actionContainerIndex,actionIndex);$("#TimerStopName").val(timerStopName);$("#dialogActionEditTimerStop").dialog("option","title","Edit timerStop in "+actionContainer+" for state "+stateName);dialogActionOpen(actionContainer,"TimerStop","edit")}}}return false}function onClickActionSave(){var actionContainer;var actionIndex=0;var actionContainerIndex=0;var command=_command;var actionType=_actionType;var stateName=getCurrentStateName();var actionView=getCurrentViewAction();var transitionView=getCurrentViewTransition();var stateView=getCurrentViewState();if(actionView){stateView=view.getStateFromAction(actionView);actionIndex=$(actionView).attr("data-action-index");actionContainer=$(getCurrentViewAction()).attr("data-action-container");actionContainerIndex=getActionContainerIndex(view,actionContainer,actionView)}else{if(transitionView){stateView=view.getStateFromTransition(transitionView);actionContainerIndex=$(transitionView).attr("data-transition-index");actionContainer="transition"}else{if(stateView){actionContainer=_actionContainer}else{return}}}var hasError=false;if(actionType=="Code"){var actionContent=$("#InputActionEdit").val();if(command=="add"){model.addCode(stateName,actionContainer,actionContainerIndex,actionContent,actionIndex)}else{var attribute=$(getCurrentViewAction()).attr("data-action-attribute");model.editCode(stateName,actionContainer,actionContainerIndex,actionContent,actionIndex,attribute)}}else{if(actionType=="TimerStart"){var timerStartName=$("#TimerStartName").val();var timerDuration=$("#TimerDuration").val();if(timerDuration==""){hasError=true;setError("#TimerDuration","duration cannot be empty")}else{if(timerStartName==undefined){hasError=true;setError("#TimerStartName","timer name cannot be empty")}else{if(command=="add"){model.timerStartAdd(stateName,actionContainer,actionContainerIndex,actionIndex,timerStartName,timerDuration)}else{model.timerStartEdit(stateName,actionContainer,actionContainerIndex,actionIndex,timerStartName,timerDuration)}}}}else{if(actionType=="TimerStop"){var timerStopName=$("#TimerStopName").val();if(timerStopName){if(command=="add"){model.timerStopAdd(stateName,actionContainer,actionContainerIndex,actionIndex,timerStopName)}else{model.timerStopEdit(stateName,actionContainer,actionContainerIndex,actionIndex,timerStopName)}}}}}if(hasError==false){$("#dialogActionEdit"+actionType).dialog("close");saveAndShowStateView()}}function onClickActionCut(evt){var stateName=getCurrentStateName();var actionView=getCurrentViewAction();var stateView=view.getStateFromAction(actionView);var actionIndex=$(actionView).attr("data-action-index");var actionContainerName=$(actionView).attr("data-action-container");var actionContainerIndex=getActionContainerIndex(view,actionContainerName,actionView);var attribute=$(getCurrentViewAction()).attr("data-action-attribute");$copiedAction=model.actionCopy(stateName,actionContainerName,actionContainerIndex,actionIndex,attribute);model.actionRemove(stateName,actionContainerName,actionContainerIndex,actionIndex,attribute);saveAndShowStateView()}function onClickActionPaste(evt){var below=evt.data.below;var stateName=getCurrentStateName();var actionView=getCurrentViewAction();var stateView=view.getStateFromAction(actionView);var actionIndex=$(actionView).attr("data-action-index");var actionContainerName=$(actionView).attr("data-action-container");var actionContainerIndex=getActionContainerIndex(view,actionContainerName,actionView);var attribute=$(getCurrentViewAction()).attr("data-action-attribute");model.actionPaste(stateName,actionContainerName,actionContainerIndex,actionIndex,below,$copiedAction);saveAndShowStateView()}function createDrilldown(name){var content=$(".DrillDownTopContainer"+name).first().clone();var drillDownId="drillDown"+name+"Cloned";$(".qtip").remove();$("#"+drillDownId).remove();content.find(".drillDown"+name).attr("id",drillDownId);var lastContainer=$(".DrillDownTopContainer"+name).last();content.insertAfter(lastContainer);$("#"+drillDownId).dcDrilldown({speed:"fast",saveState:false,showCount:false,defaultText:name+" Operations"});return content}function createEventDrilldown(){var content=createDrilldown("Event");return content}function initEventMenuCallback(){$(".EventAdd").bind("click",onClickEventAdd);$(".EventEdit").bind("click",onClickEventEdit);$(".EventCut").bind("click",onClickEventCut);$(".EventPasteAbove").bind("click",{below:false},onClickEventPaste);$(".EventPasteBelow").bind("click",{below:true},onClickEventPaste)}function initEvent(){$(".event").bind("click",function(event){var content=createEventDrilldown();setCurrentViewEvent($(this));createMenu($(this),event,content,"Event");initEventMenuCallback()})}function initDialogEvent(){createDialog("dialogEventEdit","Save event",onClickEventSave)}function initDialogEventSource(){createDialog("dialogEventSourceEdit","Save event source",onClickEventSourceSave)}function onClickEventAdd(evt){_eventIdCurrent="";_eventNameCurrent="";$("#SelectEventType").val("event");$("#InputEventId").val("");$("#InputEventParams").val("");$("#InputEventName").val("");$("#InputEventPreAction").val("");$("#InputEventPostAction").val("");$("#dialogEventEdit").dialog("option","title","Add new event");dialogEventOpen("add")}function onClickEventEdit(evt){var eventView=getCurrentViewEvent();var eventId=view.getEventId(eventView);if(eventId==undefined){return}var eventSource=view.getEventSource(eventView);_eventIdCurrent=eventId;_eventNameCurrent=model.getEventName(eventId);$("#SelectEventType").val(model.getEventType(eventId));$("#InputEventId").val(eventId);$("#InputEventParams").val(model.getEventParams(eventId));$("#InputEventName").val(eventId);$("#InputEventPreAction").val(model.getEventPreAction(eventId));$("#InputEventPostAction").val(model.getEventPostAction(eventId));$("#dialogEventEdit").dialog("option","title","Update event");dialogEventOpen("edit")}function onClickEventCut(evt){var eventView=getCurrentViewEvent();var eventId=view.getEventId(eventView);var eventSource=view.getEventSource(eventView);$copiedEvent=model.eventCopy(eventId);model.eventRemove(eventId);saveAndShowEventView()}function onClickEventPaste(evt){var below=evt.data.below;var eventView=getCurrentViewEvent();var eventId=view.getEventId(eventView);var eventSource=view.getEventSource(eventView);model.eventPaste(eventId,below,$copiedEvent);saveAndShowEventView()}function dialogEventOpen(command){hideToolTip();_command=command;$("#dialogEventEdit").dialog("open");unsetError("#InputEventName");unsetError("#InputEventId");$("#InputEventId").focus();return false}function onClickEventSave(){var command=_command;var eventView=getCurrentViewEvent();var eventIdCurrent=view.getEventId(eventView);var eventSource=view.getEventSource(eventView);var eventType=$("#SelectEventType").val();var eventIdNew=$("#InputEventId").val();var params=$("#InputEventParams").val();var eventName=$("#InputEventName").val();var preAction=$("#InputEventPreAction").val();var postAction=$("#InputEventPostAction").val();if(eventName==""&&eventType=="timer"){eventName=eventIdNew}var error=false;var errorEventId=isEventIdValid(eventIdNew);if(errorEventId){error=true;setError("#InputEventId",errorEventId)}else{if((eventIdNew!=eventIdCurrent)&&(model.hasEventId(eventIdNew)==true)){error=true;setError("#InputEventId","Duplicated event Id")}}var errorEventName=isEventNameValid(eventName);if(errorEventName){error=true;setError("#InputEventName",errorEventName)}if(error==false){if(command=="add"){model.eventAdd(eventSource,eventType,eventIdNew,params,eventName,preAction,postAction,eventIdCurrent)}else{model.eventEdit(eventSource,eventType,eventIdNew,params,eventName,preAction,postAction,eventIdCurrent)}$("#dialogEventEdit").dialog("close");saveAndShowEventView()}}function createMenu(view,event,content,name){view.qtip({prerender:true,overwrite:true,content:{text:content},position:{my:"top center",at:"bottom center",viewport:$(window)},show:{event:"click",ready:true},hide:{event:"unfocus"},style:{classes:"ui-widget",widget:true},events:{show:function(){},hide:function(){$(this).qtip("destroy");$("#drillDown"+name+"Cloned").remove()},render:function(event,api){if(event.originalEvent.button!==0){try{event.preventDefault()}catch(e){}}}}},event)}function createEventSourceDrilldown(){var content=createDrilldown("EventSource");return content}function initEventSourceMenuCallback(){$(".EventSourceAdd").bind("click",onClickEventSourceAdd);$(".EventSourceEdit").bind("click",onClickEventSourceEdit);$(".EventSourceCut").bind("click",onClickEventSourceCut);$(".EventSourcePasteAbove").bind("click",{below:false},onClickEventSourcePaste);$(".EventSourcePasteBelow").bind("click",{below:true},onClickEventSourcePaste)}function initEventSource(){$(".eventSource").bind("click",function(event){var content=createEventSourceDrilldown();setCurrentViewEvent($(this));createMenu($(this),event,content,"EventSource");initEventSourceMenuCallback()})}function onClickEventSourceAdd(evt){var eventView=getCurrentViewEvent();var eventSource=view.getEventSource(eventView);_eventSourceCurrent=eventSource;$("#InputEventSource").val("");$("#dialogEventSourceEdit").dialog("option","title","Add new event source");dialogEventSourceOpen("add")}function onClickEventSourceEdit(evt){var eventView=getCurrentViewEvent();var eventSource=view.getEventSource(eventView);if(eventSource==undefined){return}_eventSourceCurrent=eventSource;$("#InputEventSource").val(eventSource);$("#dialogEventSourceEdit").dialog("option","title","Update event source");dialogEventSourceOpen("edit")}function onClickEventSourceCut(evt){var eventView=getCurrentViewEvent();var eventSource=view.getEventSource(eventView);$copiedEventSource=model.eventSourceCopy(eventSource);model.eventSourceRemove(eventSource);saveAndShowEventView()}function onClickEventSourcePaste(evt){var below=evt.data.below;var eventView=getCurrentViewEvent();var eventSource=view.getEventSource(eventView);model.eventSourcePaste(eventSource,below,$copiedEventSource);saveAndShowEventView()}function dialogEventSourceOpen(command){hideToolTip();_command=command;$("#dialogEventSourceEdit").dialog("open");unsetError("#InputEventSource");$("#InputEventSource").focus();return false}function onClickEventSourceSave(){var command=_command;var eventView=getCurrentViewEvent();var eventSource=$("#InputEventSource").val();var error=false;if(((command=="add")||(_eventSourceCurrent!=eventSource))&&model.hasEventSource(eventSource)){error=true;setError("#InputEventSource","Event source already exist")}if(error==false){if(command=="add"){model.eventSourceAdd(_eventSourceCurrent,eventSource)}else{model.eventSourceEdit(_eventSourceCurrent,eventSource)}$("#dialogEventSourceEdit").dialog("close");saveAndShowEventView()}}function isEventIdValid(eventId){if(eventId==""){return"Event id cannot be empty"}if(eventId==_eventIdCurrent){return}var regEx=new RegExp("^[a-zA-Z_][a-zA-Z0-9_]*$");if(!regEx.test(eventId)){return"Invalid event id"}}function isEventNameValid(eventName){if(eventName==_eventNameCurrent){return}if(eventName==""){return}var regEx=new RegExp("^[a-zA-Z_][a-zA-Z0-9_]*$");if(!regEx.test(eventName)){return"Invalid event name"}if(model.hasEventName(eventName)==true){return"Duplicated event name"}}function onClickParallelAdd(evt){var stateName=getCurrentStateName();hideToolTip();unsetError("#InputSelectParallelAddNextState");$("#ParallelRegionCount").val("2");$("#InputSelectParallelAddNextState").val("");if(model.isStateRoot(stateName)==false){$("#dialogParallelNextState").css("display","");fillSelect("#SelectParallelAddNextState",model.getNextStateNameList(stateName))}else{$("#dialogParallelNextState").css("display","none")}$("#dialogParallelAdd").dialog("open");return false}function onClickParallelAddSave(evt){hideToolTip();var stateName=getCurrentStateName();var parallelCount=$("#InputParallelRegionCount").val();var nextState=$("#InputSelectParallelAddNextState").val();var hasError;if(model.isStateRoot(stateName)==false){var error=isValidNextState(nextState);if(error){hasError=true;setError("#InputSelectParallelAddNextState",error)}}if(!hasError){$("#dialogParallelAdd").dialog("close");model.parallelAdd(stateName,parallelCount,nextState);saveAndShowStateView()}}function onClickParallelEdit(evt){setCurrentViewParallel(this);var stateName=getCurrentStateName();hideToolTip();unsetError("#InputSelectParallelEditNextState");fillSelect("#SelectParallelEditNextState",model.getNextStateNameList(stateName));$("#InputSelectParallelEditNextState").val(model.parallelGetNextState(stateName));$("#dialogParallelEdit").dialog("open");return false}function onClickParallelEditSave(evt){hideToolTip();var stateName=getCurrentStateName();var nextState=$("#InputSelectParallelEditNextState").val();var hasError;var error=isValidNextState(nextState);if(error){hasError=true;setError("#InputSelectParallelEditNextState",error)}if(!hasError){$("#dialogParallelEdit").dialog("close");model.parallelEdit(stateName,nextState);saveAndShowStateView()}}function onClickParallelRemove(evt){var stateName=getCurrentStateName();hideToolTip();model.parallelRemove(stateName);saveAndShowStateView()}function getActionContainerIndex(view,actionContainer,actionView){var actionContainerIndex=0;if(actionContainer=="transition"){var transitionView=view.getTransitionFromAction(actionView);actionContainerIndex=$(transitionView).attr("data-transition-index")}return actionContainerIndex}function isValidState(stateName){if((stateName=="")||(stateName==textEnterStateName)){return"State cannot be empty"}var regEx=new RegExp("^[a-zA-Z_][a-zA-Z0-9_]*$");if(!regEx.test(stateName)){return"Invalid state name"}}function isValidNextState(stateName){if(stateName==""){return"Next state cannot be empty"}if(!stateName.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)){return"Invalid state name"}}function checkFileApi(){if(window.File&&window.FileReader&&window.FileList){apiFile=true}else{apiFile=false}}function modelModified(){if(stateEditorMainWindow!=undefined){stateEditorMainWindow.modelModified()}}}function cursor_wait(){document.body.style.cursor="wait"}function cursor_clear(){document.body.style.cursor="default"}$(document).ready(function(){browserCheck();examplesCreateAll();stateMachineInit("")});function stateMachineInit(from){stateMachineController=new StateMachineController();stateMachineController.init(from)}function stateMachineGetXmlContent(){return stateMachineController.getXmlContent()}function stateMachineSetXmlContent(){if(stateEditorMainWindow!=undefined){stateMachineInit("fromLocalFile");stateMachineController.setXmlContent(stateEditorMainWindow.getXmlContent())}}function stateMachineGetWidth(){return $("#StateMachineDiagram").children("div").width()+2}function stateMachineGetOffsetLeft(){return $("#StateMachineDiagram").children("div").offset().left}function stateMachineGetHeight(){return $("#StateMachineDiagram").children("div").height()+2}function stateMachineGetOffsetTop(){return $("#StateMachineDiagram").children("div").offset().top}function stateMachineRemoveBackground(){$("#TabView,body").removeClass("ui-widget-content")}function stateMachineAddBackground(){$("#TabView,body").addClass("ui-widget-content")}(function($){$.widget("ui.combobox",{_create:function(){var self=this,select=this.element.hide(),selected=select.children(":selected"),value=selected.val()?selected.text():"";var input=this.input=$("<input>").insertAfter(select).val(value).autocomplete({delay:0,minLength:0,source:function(request,response){var matcher=new RegExp($.ui.autocomplete.escapeRegex(request.term),"i");response(select.children("option").map(function(){var text=$(this).text();if(this.value&&(!request.term||matcher.test(text))){return{label:text.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+$.ui.autocomplete.escapeRegex(request.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"),value:text,option:this}}}))},select:function(event,ui){ui.item.option.selected=true;self._trigger("selected",event,{item:ui.item.option})},change:function(event,ui){if(!ui.item){var matcher=new RegExp("^"+$.ui.autocomplete.escapeRegex($(this).val())+"$","i"),valid=false;select.children("option").each(function(){if($(this).text().match(matcher)){this.selected=valid=true;return false}})}}}).addClass("ui-widget ui-widget-content ui-corner-left");input.attr("id","Input"+select.attr("id"));input.data("autocomplete")._renderItem=function(ul,item){return $("<li></li>").data("item.autocomplete",item).append("<a>"+item.label+"</a>").appendTo(ul)};this.button=$("<button type='button'>&nbsp;</button>").attr("tabIndex",-1).attr("title","Show All Items").insertAfter(input).button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).removeClass("ui-corner-all").addClass("ui-corner-right ui-button-icon").click(function(){if(input.autocomplete("widget").is(":visible")){input.autocomplete("close");return}$(this).blur();input.autocomplete("search","");input.focus()})},destroy:function(){this.input.remove();this.button.remove();this.element.show();$.Widget.prototype.destroy.call(this)}})})(jQuery);